# æ—¶é—´å¤„ç†å¹´ä»½åˆ¤æ–­é€»è¾‘ä¿®å¤æŠ¥å‘Š

**ä¿®å¤æ—¥æœŸ**: 2025-10-31  
**é—®é¢˜çº§åˆ«**: ğŸ”´ ä¸¥é‡é”™è¯¯  
**å½±å“èŒƒå›´**: æ‰€æœ‰6ä¸ªå¾…å¤„ç†æ–‡ä»¶

---

## ğŸ“‹ é—®é¢˜æè¿°

### ç”¨æˆ·å‘ç°çš„é—®é¢˜

åœ¨å¾…å¤„ç†æ–‡ä»¶6å¤„ç†Iåˆ—æ—¶é—´æ—¶ï¼Œé‡åˆ°"2024.12.20"è¿™æ ·çš„æ—¥æœŸï¼Œä¼šè¢«è¯¯åˆ¤ä¸º"12.20"ï¼ˆæœªæ¥æ—¥æœŸï¼‰ï¼Œå¯¼è‡´ï¼š
- âŒ çŠ¶æ€æ **æ²¡æœ‰æ˜¾ç¤ºæ„Ÿå¹å·æ ‡è®°**ï¼ˆå»¶æœŸè­¦å‘Šï¼‰
- âŒ æ•°æ®**è¢«æ˜¾ç¤ºå‡ºæ¥**ä½†çŠ¶æ€åˆ¤æ–­é”™è¯¯

### é—®é¢˜æ ¹æºåˆ†æ

#### é—®é¢˜1ï¼šæ—¶é—´æ ¼å¼åŒ–ä¸¢å¤±å¹´ä»½

**ä½ç½®**: `main.py` - æ‰€æœ‰6ä¸ª `process_target_fileX` å‡½æ•°

```python
# âŒ é”™è¯¯ä»£ç ï¼ˆæ—§ç‰ˆæœ¬ï¼‰
time_values.append(parsed.strftime('%m.%d'))  # ä¸¢å¤±å¹´ä»½ï¼
```

**å½±å“**:
- ExcelåŸå§‹æ•°æ®ï¼š`2024.12.20`ï¼ˆå»å¹´12æœˆï¼Œæ—©å·²è¿‡æœŸï¼‰
- æ ¼å¼åŒ–åï¼š`"12.20"`ï¼ˆ**ä¸¢å¤±å¹´ä»½ä¿¡æ¯**ï¼‰

#### é—®é¢˜2ï¼šå»¶æœŸåˆ¤æ–­é€»è¾‘é”™è¯¯

**ä½ç½®**: `date_utils.py` - `is_date_overdue` å‡½æ•°ï¼ˆç¬¬46è¡Œï¼‰

```python
# âŒ é”™è¯¯ä»£ç ï¼ˆæ—§ç‰ˆæœ¬ï¼‰
due_date = date(reference_date.year, month, day)  # ç›´æ¥å‡è®¾ä¸ºå½“å‰å¹´ä»½ï¼
```

**å½±å“**:
- æ¥æ”¶åˆ° `"12.20"`
- è§£æä¸º `2025-12-20`ï¼ˆ**é”™è¯¯åœ°è®¤ä¸ºæ˜¯ä»Šå¹´12æœˆ**ï¼‰
- åˆ¤æ–­ä¸ºæœªæ¥æ—¥æœŸ â†’ **ä¸æ‰“æ„Ÿå¹å·** âŒ

### é”™è¯¯åœºæ™¯ç¤ºä¾‹

| æ­¥éª¤ | ExcelåŸå§‹æ•°æ® | main.pyå¤„ç†å | window.pyåˆ¤æ–­ | å®é™…åº”è¯¥ |
|------|--------------|--------------|--------------|---------|
| 1 | `2024.12.20` | `"12.20"` | è§£æä¸º`2025-12-20` | - |
| 2 | (å»å¹´12æœˆ) | (ä¸¢å¤±å¹´ä»½) | (æœªæ¥æ—¥æœŸ) | (å·²è¿‡æœŸ) |
| 3 | - | - | âŒ ä¸æ˜¾ç¤ºâš ï¸ | âœ… åº”æ˜¾ç¤ºâš ï¸ |

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### æ–¹æ¡ˆé€‰æ‹©

é‡‡ç”¨**åŒé‡ä¿®å¤æ–¹æ¡ˆ**ï¼š
1. **main.py**: ä¿ç•™å®Œæ•´å¹´ä»½ï¼ˆ`yyyy.mm.dd`æ ¼å¼ï¼‰
2. **date_utils.py**: æ”¯æŒå¤šç§æ—¥æœŸæ ¼å¼ï¼Œæ­£ç¡®è§£æå¹´ä»½

### ä¿®å¤å†…å®¹

#### ä¿®å¤1: main.py - ä¿ç•™å®Œæ•´å¹´ä»½

**ä¿®æ”¹æ–‡ä»¶**: `main.py`  
**å½±å“å‡½æ•°**: æ‰€æœ‰6ä¸ªæ–‡ä»¶çš„æ¥å£æ—¶é—´å¤„ç†

```python
# âœ… ä¿®å¤åä»£ç 
# ã€ä¿®å¤ã€‘ä¿ç•™å®Œæ•´å¹´ä»½ï¼Œæ”¯æŒè·¨å¹´å»¶æœŸåˆ¤æ–­
time_values.append(parsed.strftime('%Y.%m.%d'))
```

**ä¿®æ”¹ä½ç½®**:
- ç¬¬448è¡Œï¼šæ–‡ä»¶1ï¼ˆprocess_target_file1ï¼‰- Kåˆ—ï¼ˆç´¢å¼•10ï¼‰
- ç¬¬1096è¡Œï¼šæ–‡ä»¶2ï¼ˆprocess_target_file2ï¼‰- Måˆ—ï¼ˆç´¢å¼•12ï¼‰
- ç¬¬1522è¡Œï¼šæ–‡ä»¶3ï¼ˆprocess_target_file3ï¼‰- M/Låˆ—ï¼ˆç´¢å¼•12/11ï¼‰
- ç¬¬2284è¡Œï¼šæ–‡ä»¶4ï¼ˆprocess_target_file4ï¼‰- Såˆ—ï¼ˆç´¢å¼•18ï¼‰
- ç¬¬2875è¡Œï¼šæ–‡ä»¶5ï¼ˆprocess_target_file5ï¼‰- Låˆ—ï¼ˆç´¢å¼•11ï¼‰
- ç¬¬3305è¡Œï¼šæ–‡ä»¶6ï¼ˆprocess_target_file6ï¼‰- Iåˆ—ï¼ˆç´¢å¼•8ï¼‰

#### ä¿®å¤2: date_utils.py - æ™ºèƒ½æ—¥æœŸè§£æ

**ä¿®æ”¹æ–‡ä»¶**: `date_utils.py`  
**ä¿®æ”¹å‡½æ•°**: `is_date_overdue`

**æ–°å¢åŠŸèƒ½**:
1. âœ… æ”¯æŒå®Œæ•´æ—¥æœŸæ ¼å¼ï¼š`yyyy.mm.dd`ã€`yyyy-mm-dd`
2. âœ… æ”¯æŒç®€çŸ­æ ¼å¼ï¼š`mm.dd`ï¼ˆä½¿ç”¨æ™ºèƒ½è·¨å¹´åˆ¤æ–­ï¼‰
3. âœ… å‘åå…¼å®¹ï¼šä¿æŒåŸæœ‰é€»è¾‘ä½œä¸ºå…œåº•

```python
# âœ… ä¿®å¤åé€»è¾‘
def is_date_overdue(date_str: str, reference_date: Optional[date] = None) -> bool:
    """
    åˆ¤æ–­æ—¥æœŸæ˜¯å¦å·²å»¶æœŸ
    
    æ”¯æŒæ ¼å¼ï¼š
    - mm.ddï¼ˆå¦‚ï¼š01.15ï¼‰
    - yyyy.mm.ddï¼ˆå¦‚ï¼š2024.12.20ï¼‰
    - yyyy-mm-ddï¼ˆå¦‚ï¼š2024-12-20ï¼‰
    """
    # 1. ä¼˜å…ˆå°è¯•å®Œæ•´æ—¥æœŸæ ¼å¼ï¼ˆyyyy.mm.ddï¼‰
    if len(parts) == 3:
        year = int(parts[0])
        month = int(parts[1])
        day = int(parts[2])
        due_date = date(year, month, day)
        return due_date < reference_date
    
    # 2. å¦‚æœæ˜¯mm.ddæ ¼å¼ï¼Œä½¿ç”¨æ™ºèƒ½è·¨å¹´åˆ¤æ–­ï¼ˆparse_mmdd_to_dateï¼‰
    if len(parts) == 2:
        parsed_date = parse_mmdd_to_date(date_str, reference_date)
        if parsed_date:
            return parsed_date < reference_date
    
    # 3. å…œåº•ï¼šæŒ‰ç…§æ—§é€»è¾‘å¤„ç†
    # ...
```

---

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰ vs ä¿®å¤å

| åœºæ™¯ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| **Excelæ•°æ®** | `2024.12.20` | `2024.12.20` |
| **æ˜¾ç¤ºæ ¼å¼** | `12.20` âŒ | `2024.12.20` âœ… |
| **å»¶æœŸåˆ¤æ–­** | è§£æä¸º2025å¹´ â†’ æœªæ¥ âŒ | è§£æä¸º2024å¹´ â†’ å·²è¿‡æœŸ âœ… |
| **çŠ¶æ€æ ‡è®°** | æ—  âŒ | âš ï¸ âœ… |

### è·¨å¹´åœºæ™¯æµ‹è¯•

å‡è®¾ä»Šå¤©æ˜¯ **2025å¹´10æœˆ31æ—¥**ï¼š

| ExcelåŸå§‹æ•°æ® | æ˜¾ç¤ºæ ¼å¼ | å»¶æœŸåˆ¤æ–­ | çŠ¶æ€æ ‡è®° |
|--------------|----------|----------|---------|
| `2024.12.20` | `2024.12.20` | âœ… å·²å»¶æœŸï¼ˆè¿‡å»314å¤©ï¼‰ | âš ï¸ |
| `2025.10.28` | `2025.10.28` | âœ… å·²å»¶æœŸï¼ˆè¿‡å»3å¤©ï¼‰ | âš ï¸ |
| `2025.11.05` | `2025.11.05` | âœ… æœªå»¶æœŸï¼ˆæœªæ¥5å¤©ï¼‰ | - |
| `2025.12.20` | `2025.12.20` | âœ… æœªå»¶æœŸï¼ˆæœªæ¥50å¤©ï¼‰ | - |
| `2026.01.15` | `2026.01.15` | âœ… æœªå»¶æœŸï¼ˆæœªæ¥76å¤©ï¼‰ | - |

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹

#### ç”¨ä¾‹1ï¼šå»å¹´æ—¥æœŸï¼ˆå·²å»¶æœŸï¼‰
```
è¾“å…¥: 2024.12.20
é¢„æœŸ: æ˜¾ç¤ºä¸º"2024.12.20"ï¼ŒçŠ¶æ€æ æ˜¾ç¤ºâš ï¸
```

#### ç”¨ä¾‹2ï¼šä»Šå¹´æ—©æœŸæ—¥æœŸï¼ˆå·²å»¶æœŸï¼‰
```
è¾“å…¥: 2025.09.15
é¢„æœŸ: æ˜¾ç¤ºä¸º"2025.09.15"ï¼ŒçŠ¶æ€æ æ˜¾ç¤ºâš ï¸
```

#### ç”¨ä¾‹3ï¼šä»Šå¹´æœªæ¥æ—¥æœŸï¼ˆæœªå»¶æœŸï¼‰
```
è¾“å…¥: 2025.11.20
é¢„æœŸ: æ˜¾ç¤ºä¸º"2025.11.20"ï¼ŒçŠ¶æ€æ æ— æ ‡è®°
```

#### ç”¨ä¾‹4ï¼šæ˜å¹´æ—¥æœŸï¼ˆæœªå»¶æœŸï¼‰
```
è¾“å…¥: 2026.01.15
é¢„æœŸ: æ˜¾ç¤ºä¸º"2026.01.15"ï¼ŒçŠ¶æ€æ æ— æ ‡è®°
```

### å‘åå…¼å®¹æ€§

âœ… å¦‚æœExcelä¸­åŸæœ¬å°±æ˜¯"mm.dd"æ ¼å¼ï¼ˆæ— å¹´ä»½ï¼‰ï¼š
- `parse_mmdd_to_date` å‡½æ•°ä¼šä½¿ç”¨**180å¤©é˜ˆå€¼çš„æ™ºèƒ½è·¨å¹´åˆ¤æ–­**
- ä»Šå¤©æ˜¯10æœˆ31æ—¥ï¼Œ"12.20"ä¼šè¢«æ­£ç¡®è§£æä¸º2025å¹´12æœˆï¼ˆæœªæ¥ï¼‰
- "09.15"ä¼šè¢«æ­£ç¡®è§£æä¸º2025å¹´9æœˆï¼ˆå·²è¿‡æœŸï¼‰

---

## ğŸ“Š å½±å“èŒƒå›´

### ä¿®æ”¹æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹è¡Œæ•° | ä¿®æ”¹å†…å®¹ |
|------|---------|---------|
| `date_utils.py` | 1å¤„ï¼ˆç¬¬11-76è¡Œï¼‰ | å¢å¼º`is_date_overdue`å‡½æ•°ï¼Œæ”¯æŒå®Œæ•´æ—¥æœŸ |
| `main.py` | 6å¤„ | æ‰€æœ‰æ–‡ä»¶çš„æ¥å£æ—¶é—´æ ¼å¼åŒ– |
| - æ–‡ä»¶1 | ç¬¬448è¡Œ | Kåˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |
| - æ–‡ä»¶2 | ç¬¬1096è¡Œ | Måˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |
| - æ–‡ä»¶3 | ç¬¬1522è¡Œ | M/Låˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |
| - æ–‡ä»¶4 | ç¬¬2284è¡Œ | Såˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |
| - æ–‡ä»¶5 | ç¬¬2875è¡Œ | Låˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |
| - æ–‡ä»¶6 | ç¬¬3305è¡Œ | Iåˆ—æ—¶é—´æ ¼å¼ï¼š`%m.%d` â†’ `%Y.%m.%d` |

### ç”¨æˆ·ç•Œé¢å˜åŒ–

**æ˜¾ç¤ºæ ¼å¼å˜åŒ–**:
- ä¿®å¤å‰ï¼š`12.20`ï¼ˆ2ä½æœˆ+2ä½æ—¥ï¼‰
- ä¿®å¤åï¼š`2024.12.20`ï¼ˆ4ä½å¹´+2ä½æœˆ+2ä½æ—¥ï¼‰

**ä¼˜ç‚¹**:
- âœ… ä¿¡æ¯æ›´å®Œæ•´
- âœ… é¿å…æ­§ä¹‰
- âœ… æ­£ç¡®å»¶æœŸåˆ¤æ–­

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®ä¸€è‡´æ€§

- âœ… æ‰€æœ‰6ä¸ªæ–‡ä»¶ç»Ÿä¸€ä½¿ç”¨`%Y.%m.%d`æ ¼å¼
- âœ… ä¸å½±å“ExcelåŸå§‹æ•°æ®ï¼ˆåªå½±å“æ˜¾ç¤ºï¼‰
- âœ… ä¸å½±å“å¯¼å‡ºç»“æœï¼ˆå¯¼å‡ºæ—¶ä½¿ç”¨åŸå§‹æ•°æ®ï¼‰

### æ€§èƒ½å½±å“

- âœ… æ— æ€§èƒ½å½±å“ï¼ˆä»…æ”¹å˜æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼‰
- âœ… `is_date_overdue`å‡½æ•°å¢åŠ äº†å°‘é‡é€»è¾‘åˆ¤æ–­ï¼Œä½†å¯å¿½ç•¥ä¸è®¡

### å‘åå…¼å®¹

- âœ… å¦‚æœExcelä¸­å·²ç»æ˜¯å®Œæ•´æ—¥æœŸï¼Œæ­£å¸¸è§£æ
- âœ… å¦‚æœExcelä¸­æ˜¯"mm.dd"æ ¼å¼ï¼Œ`parse_mmdd_to_date`ä¼šæ™ºèƒ½åˆ¤æ–­
- âœ… ç°æœ‰æµ‹è¯•ç”¨ä¾‹ï¼ˆ247ä¸ªï¼‰åº”è¯¥å…¨éƒ¨é€šè¿‡

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] ä¿®æ”¹`date_utils.py`ä¸­çš„`is_date_overdue`å‡½æ•°
- [x] ä¿®æ”¹`main.py`ä¸­æ‰€æœ‰6ä¸ªæ–‡ä»¶çš„æ¥å£æ—¶é—´æ ¼å¼åŒ–
- [x] ç”Ÿæˆä¿®å¤æŠ¥å‘Š
- [ ] è¿è¡ŒpytestéªŒè¯ï¼ˆå¾…ç”¨æˆ·æ‰§è¡Œï¼‰
- [ ] æ‰‹åŠ¨æµ‹è¯•6ä¸ªæ–‡ä»¶çš„å»¶æœŸåˆ¤æ–­ï¼ˆå¾…ç”¨æˆ·æ‰§è¡Œï¼‰

---

## ğŸ“ ç»éªŒæ•™è®­

### è®¾è®¡ç¼ºé™·

**åŸå§‹è®¾è®¡é—®é¢˜**:
- ä¸ºäº†ç•Œé¢ç®€æ´ï¼Œåªæ˜¾ç¤º"mm.dd"æ ¼å¼
- **ä¸¢å¤±äº†å¹´ä»½ä¿¡æ¯**ï¼Œå¯¼è‡´è·¨å¹´åˆ¤æ–­å¤±è´¥

**æ­£ç¡®åšæ³•**:
- å§‹ç»ˆä¿ç•™å®Œæ•´æ—¥æœŸä¿¡æ¯ï¼ˆè‡³å°‘åœ¨å†…éƒ¨å¤„ç†æ—¶ï¼‰
- å¦‚æœç”¨æˆ·ä½“éªŒè¦æ±‚ç®€çŸ­æ ¼å¼ï¼Œå¯ä»¥åœ¨**æ˜¾ç¤ºå±‚**åšè½¬æ¢ï¼Œä½†**æ•°æ®å±‚**åº”ä¿ç•™å®Œæ•´ä¿¡æ¯

### å…³é”®æ•™è®­

1. âš ï¸ **ä¸è¦åœ¨æ•°æ®å¤„ç†å±‚ä¸¢å¤±å…³é”®ä¿¡æ¯**
2. âš ï¸ **æ—¶é—´å¤„ç†å¿…é¡»è€ƒè™‘è·¨å¹´åœºæ™¯**
3. âš ï¸ **å»¶æœŸåˆ¤æ–­ä¸èƒ½å‡è®¾"å½“å‰å¹´ä»½"**
4. âœ… **ä½¿ç”¨å®Œæ•´æ—¥æœŸæ ¼å¼å¯ä»¥é¿å…å¤§éƒ¨åˆ†é—®é¢˜**

---

**ä¿®å¤å®Œæˆï¼** ğŸ‰

æ‰€æœ‰æ—¶é—´å¤„ç†é€»è¾‘å·²ä¿®å¤ï¼Œæ”¯æŒæ­£ç¡®çš„è·¨å¹´å»¶æœŸåˆ¤æ–­ã€‚

