# è‡ªåŠ¨æ›´æ–°åŠŸèƒ½è®¾è®¡æ–¹æ¡ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´10æœˆ27æ—¥  
**çŠ¶æ€**: ğŸ“‹ å¾…å®æ–½ï¼ˆå·²æç½®ï¼‰  
**é¢„è®¡å·¥ä½œé‡**: 2ä¸ªå·¥ä½œæ—¥ï¼ˆ11-16å°æ—¶ï¼‰

---

## ğŸ“‹ éœ€æ±‚æ¦‚è¿°

### åŠŸèƒ½ç›®æ ‡

1. **é…ç½®åŒæ­¥**: ç¨‹åºå¯åŠ¨æ—¶ä»æœåŠ¡å™¨è¯»å–æœ€æ–°é…ç½®
2. **æ‰‹åŠ¨æ›´æ–°**: è®¾ç½®èœå•æ·»åŠ "æ£€æŸ¥æ›´æ–°"æŒ‰é’®
3. **è‡ªåŠ¨æ£€æµ‹**: ç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ç‰ˆæœ¬å¹¶æç¤ºæ›´æ–°
4. **è·³è¿‡ç‰ˆæœ¬**: ç”¨æˆ·å¯é€‰æ‹©è·³è¿‡æŸä¸ªç‰ˆæœ¬ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒ

### æœåŠ¡å™¨è·¯å¾„

```
\\10.102.2.7\æ–‡ä»¶æœåŠ¡å™¨\å»ºç­‘ç»“æ„æ‰€\æ¥å£æ–‡ä»¶\
```

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®¢æˆ·ç«¯ç¨‹åº                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  base.py (ä¸»ç¨‹åº)                                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ å¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–° (_check_update_on_startup)         â”‚  â”‚
â”‚  â”‚  â”œâ”€ æ‰‹åŠ¨æ£€æŸ¥æ›´æ–° (_manual_check_update)               â”‚  â”‚
â”‚  â”‚  â””â”€ æ‰§è¡Œæ›´æ–° (_do_update)                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  version_manager.py (ç‰ˆæœ¬ç®¡ç†å™¨)                       â”‚  â”‚
â”‚  â”‚  â”œâ”€ check_update() - æ£€æŸ¥æ›´æ–°                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ download_update() - ä¸‹è½½æ›´æ–°                      â”‚  â”‚
â”‚  â”‚  â”œâ”€ apply_update() - åº”ç”¨æ›´æ–°                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ skip_version() - è·³è¿‡ç‰ˆæœ¬                         â”‚  â”‚
â”‚  â”‚  â””â”€ sync_config_from_server() - åŒæ­¥é…ç½®              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  update_dialog.py (æ›´æ–°å¯¹è¯æ¡†)                         â”‚  â”‚
â”‚  â”‚  â”œâ”€ UpdateDialog - æ›´æ–°æç¤ºå¯¹è¯æ¡†                     â”‚  â”‚
â”‚  â”‚  â””â”€ DownloadProgressDialog - ä¸‹è½½è¿›åº¦å¯¹è¯æ¡†           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†• ç½‘ç»œè®¿é—®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æœåŠ¡å™¨ (10.102.2.7)                             â”‚
â”‚  \\10.102.2.7\æ–‡ä»¶æœåŠ¡å™¨\å»ºç­‘ç»“æ„æ‰€\æ¥å£æ–‡ä»¶\                â”‚
â”‚  â”œâ”€ version.json          # ç‰ˆæœ¬ä¿¡æ¯æ–‡ä»¶                    â”‚
â”‚  â”œâ”€ config.json           # å…±äº«é…ç½®æ–‡ä»¶                    â”‚
â”‚  â”œâ”€ å§“åè§’è‰²è¡¨.xlsx       # è§’è‰²è¡¨                          â”‚
â”‚  â”œâ”€ æ¥å£ç­›é€‰_v1.2.0.exe   # æœ€æ–°ç‰ˆæœ¬ç¨‹åº                    â”‚
â”‚  â””â”€ changelog.txt         # æ›´æ–°æ—¥å¿—ï¼ˆå¯é€‰ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„è®¾è®¡

### æœåŠ¡å™¨ç«¯æ–‡ä»¶

#### 1. version.jsonï¼ˆç‰ˆæœ¬ä¿¡æ¯æ–‡ä»¶ï¼‰

```json
{
  "version": "1.2.0",
  "release_date": "2025-10-27",
  "exe_filename": "æ¥å£ç­›é€‰_v1.2.0.exe",
  "md5_hash": "a1b2c3d4e5f6...",
  "changelog": "ä¿®å¤äº†å‹¾é€‰åŠŸèƒ½bug\næ–°å¢äº†ç¼“å­˜åŠŸèƒ½\nä¼˜åŒ–äº†Excelè¯»å–æ€§èƒ½",
  "force_update": false,
  "min_compatible_version": "1.0.0",
  "file_size_mb": 45.6
}
```

**å­—æ®µè¯´æ˜**ï¼š
- `version`: ç‰ˆæœ¬å·ï¼ˆè¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼Œå¦‚ 1.2.0ï¼‰
- `release_date`: å‘å¸ƒæ—¥æœŸ
- `exe_filename`: exeæ–‡ä»¶åï¼ˆæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶åï¼‰
- `md5_hash`: MD5æ ¡éªŒå’Œï¼ˆç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§ï¼‰
- `changelog`: æ›´æ–°æ—¥å¿—ï¼ˆæ”¯æŒå¤šè¡Œï¼Œç”¨\nåˆ†éš”ï¼‰
- `force_update`: æ˜¯å¦å¼ºåˆ¶æ›´æ–°ï¼ˆtrueæ—¶ä¸å…è®¸è·³è¿‡ï¼‰
- `min_compatible_version`: æœ€ä½å…¼å®¹ç‰ˆæœ¬
- `file_size_mb`: æ–‡ä»¶å¤§å°ï¼ˆç”¨äºæ˜¾ç¤ºä¸‹è½½è¿›åº¦ï¼‰

---

#### 2. config.jsonï¼ˆå…±äº«é…ç½®æ–‡ä»¶ï¼‰

```json
{
  "shared_settings": {
    "server_role_table_path": "\\\\10.102.2.7\\æ–‡ä»¶æœåŠ¡å™¨\\å»ºç­‘ç»“æ„æ‰€\\æ¥å£æ–‡ä»¶\\å§“åè§’è‰²è¡¨.xlsx",
    "default_folder_hint": "è¯·é€‰æ‹©åŒ…å«Excelæ–‡ä»¶çš„æ–‡ä»¶å¤¹"
  },
  "update_settings": {
    "enable_auto_check": true,
    "check_interval_hours": 24
  }
}
```

**æ³¨æ„**ï¼šå®¢æˆ·ç«¯åªè¯»å– `shared_settings` éƒ¨åˆ†ï¼Œä¸è¦†ç›–ç”¨æˆ·ä¸ªäººé…ç½®ã€‚

---

### å®¢æˆ·ç«¯æ–‡ä»¶

#### 1. config.jsonï¼ˆæœ¬åœ°é…ç½®æ–‡ä»¶ - æ–°å¢å­—æ®µï¼‰

```json
{
  "folder_path": "D:/Programs/ç­›é€‰ç¨‹åº/ç®€æ˜“æµ‹è¯•æ–‡ä»¶",
  "auto_startup": false,
  "minimize_to_tray": true,
  "dont_ask_again": false,
  "user_name": "å¼ ä¸‰",
  
  // ===== æ–°å¢å­—æ®µ =====
  "current_version": "1.1.0",
  "skipped_versions": ["1.1.5", "1.1.8"],
  "last_check_time": "2025-10-27 10:30:00",
  "auto_check_update": true
}
```

**æ–°å¢å­—æ®µè¯´æ˜**ï¼š
- `current_version`: å½“å‰ç¨‹åºç‰ˆæœ¬ï¼ˆä»ä»£ç ç¡¬ç¼–ç è¯»å–ï¼Œç”¨äºæ¯”å¯¹ï¼‰
- `skipped_versions`: ç”¨æˆ·é€‰æ‹©è·³è¿‡çš„ç‰ˆæœ¬åˆ—è¡¨
- `last_check_time`: æœ€åä¸€æ¬¡æ£€æŸ¥æ›´æ–°çš„æ—¶é—´
- `auto_check_update`: æ˜¯å¦å¯ç”¨è‡ªåŠ¨æ£€æŸ¥æ›´æ–°

---

## ğŸ”„ æ ¸å¿ƒæµç¨‹è®¾è®¡

### æµç¨‹1ï¼šç¨‹åºå¯åŠ¨æ—¶è‡ªåŠ¨æ£€æŸ¥æ›´æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç¨‹åºå¯åŠ¨ (ExcelProcessorApp.__init__)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. åˆå§‹åŒ– VersionManager                                     â”‚
â”‚    - è¯»å–æœ¬åœ° current_version                                â”‚
â”‚    - è¯»å– skipped_versions                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åŒæ­¥æœåŠ¡å™¨é…ç½® (sync_config_from_server)                 â”‚
â”‚    - è¯»å–æœåŠ¡å™¨ config.json çš„ shared_settings               â”‚
â”‚    - æ›´æ–°æœ¬åœ°å§“åè§’è‰²è¡¨è·¯å¾„ç­‰å…±äº«é…ç½®                        â”‚
â”‚    - å¤±è´¥ä¸é˜»å¡ï¼Œè®°å½•æ—¥å¿—                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å»¶è¿Ÿæ£€æŸ¥æ›´æ–°ï¼ˆé¿å…é˜»å¡ç•Œé¢ï¼‰                              â”‚
â”‚    - æ™®é€šæ¨¡å¼: self.root.after(500ms, _check_update)        â”‚
â”‚    - è‡ªåŠ¨æ¨¡å¼: ç«‹å³æ£€æŸ¥ä½†ä¸æ˜¾ç¤ºæç¤º                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åå°çº¿ç¨‹æ£€æŸ¥æ›´æ–° (threading.Thread)                      â”‚
â”‚    â”œâ”€ è¿æ¥æœåŠ¡å™¨ï¼ˆè¶…æ—¶3ç§’ï¼‰                                  â”‚
â”‚    â”œâ”€ è¯»å– version.json                                      â”‚
â”‚    â”œâ”€ æ¯”è¾ƒç‰ˆæœ¬å·                                             â”‚
â”‚    â””â”€ è¿”å›ç»“æœåˆ°ä¸»çº¿ç¨‹                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœåŠ¡å™¨ç‰ˆæœ¬ > æœ¬åœ° â”‚            â”‚ æœåŠ¡å™¨ç‰ˆæœ¬ <= æœ¬åœ°â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                                  â†“
         â†“                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                        â”‚ ç»§ç»­è¿è¡Œï¼Œä¸æç¤º  â”‚
         â†“                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. æ£€æŸ¥æ˜¯å¦è·³è¿‡æ­¤ç‰ˆæœ¬                                        â”‚
â”‚    - å¦‚æœ version in skipped_versions                        â”‚
â”‚      â†’ è·³è¿‡æç¤ºï¼Œç»§ç»­è¿è¡Œ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡† (UpdateDialog)                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬                                       â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ å½“å‰ç‰ˆæœ¬: v1.1.0                                  â”‚    â”‚
â”‚    â”‚ æœ€æ–°ç‰ˆæœ¬: v1.2.0                                  â”‚    â”‚
â”‚    â”‚ å‘å¸ƒæ—¥æœŸ: 2025-10-27                              â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ æ›´æ–°å†…å®¹:                                         â”‚    â”‚
â”‚    â”‚ â€¢ ä¿®å¤äº†å‹¾é€‰åŠŸèƒ½bug                               â”‚    â”‚
â”‚    â”‚ â€¢ æ–°å¢äº†ç¼“å­˜åŠŸèƒ½                                  â”‚    â”‚
â”‚    â”‚ â€¢ ä¼˜åŒ–äº†Excelè¯»å–æ€§èƒ½                             â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ [ ] ä¸å†æé†’æ­¤ç‰ˆæœ¬                                â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ [ç«‹å³æ›´æ–°] [è·³è¿‡æ­¤ç‰ˆæœ¬] [ç¨åæé†’]                 â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                â†“                â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ç«‹å³æ›´æ–°  â”‚      â”‚è·³è¿‡æ­¤ç‰ˆæœ¬â”‚     â”‚ç¨åæé†’  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                â†“                â†“
  æ‰§è¡Œæ›´æ–°æµç¨‹    æ·»åŠ åˆ°skipped_   ç»§ç»­è¿è¡Œ
  (è§æµç¨‹3)        versions
```

---

### æµç¨‹2ï¼šæ‰‹åŠ¨æ£€æŸ¥æ›´æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"æŒ‰é’®                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ˜¾ç¤º"æ£€æŸ¥ä¸­"æç¤ºæ¡†                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ æ£€æŸ¥æ›´æ–°                                           â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚        æ­£åœ¨æ£€æŸ¥æ›´æ–°...                             â”‚    â”‚
â”‚    â”‚        [è¿›åº¦åŠ¨ç”»]                                 â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åå°çº¿ç¨‹æ£€æŸ¥ (threading.Thread)                          â”‚
â”‚    - è¿æ¥æœåŠ¡å™¨ï¼ˆè¶…æ—¶5ç§’ï¼Œæ¯”è‡ªåŠ¨æ£€æŸ¥æ›´é•¿ï¼‰                    â”‚
â”‚    - è¯»å– version.json                                       â”‚
â”‚    - æ¯”è¾ƒç‰ˆæœ¬å·                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿æ¥æˆåŠŸ          â”‚            â”‚ è¿æ¥å¤±è´¥          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                                  â†“
         â†“                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                        â”‚ æç¤º"æ— æ³•è¿æ¥åˆ°   â”‚
         â†“                        â”‚ æœåŠ¡å™¨"           â”‚
         â†“                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å…³é—­"æ£€æŸ¥ä¸­"æç¤ºæ¡†                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æœ‰æ–°ç‰ˆæœ¬          â”‚            â”‚ å·²æ˜¯æœ€æ–°ç‰ˆæœ¬      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                                  â†“
  æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  (åŒæµç¨‹1çš„æ­¥éª¤7)            â”‚ æç¤º"å½“å‰å·²æ˜¯æœ€æ–° â”‚
                              â”‚ ç‰ˆæœ¬ v1.1.0"      â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æµç¨‹3ï¼šä¸‹è½½å¹¶åº”ç”¨æ›´æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·é€‰æ‹©"ç«‹å³æ›´æ–°"                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ˜¾ç¤ºä¸‹è½½è¿›åº¦å¯¹è¯æ¡† (DownloadProgressDialog)              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ ä¸‹è½½æ›´æ–°                                           â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ æ­£åœ¨ä¸‹è½½: æ¥å£ç­›é€‰_v1.2.0.exe                      â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘] 65%                        â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ å·²ä¸‹è½½: 30.5 MB / 45.6 MB                         â”‚    â”‚
â”‚    â”‚ é€Ÿåº¦: 5.2 MB/s                                    â”‚    â”‚
â”‚    â”‚ å‰©ä½™æ—¶é—´: çº¦ 3 ç§’                                  â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚              [å–æ¶ˆä¸‹è½½]                            â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ä¸‹è½½æ–‡ä»¶åˆ°ä¸´æ—¶ä½ç½®                                         â”‚
â”‚    æº: \\10.102.2.7\...\æ¥å£ç­›é€‰_v1.2.0.exe                  â”‚
â”‚    ç›®æ ‡: ./æ¥å£ç­›é€‰_v1.2.0.exe.tmp                            â”‚
â”‚    - åˆ†å—ä¸‹è½½ï¼ˆ1MB per chunkï¼‰                                â”‚
â”‚    - å®æ—¶æ›´æ–°è¿›åº¦å›è°ƒ                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§                                             â”‚
â”‚    - è®¡ç®—ä¸‹è½½æ–‡ä»¶çš„MD5                                        â”‚
â”‚    - ä¸ version.json ä¸­çš„ md5_hash æ¯”å¯¹                      â”‚
â”‚    - ä¸ä¸€è‡´ â†’ æç¤ºé”™è¯¯ï¼Œåˆ é™¤ä¸´æ—¶æ–‡ä»¶                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å¤‡ä»½å½“å‰ç‰ˆæœ¬                                               â”‚
â”‚    - å°† æ¥å£ç­›é€‰.exe é‡å‘½åä¸º æ¥å£ç­›é€‰.exe.backup             â”‚
â”‚    - ä¿ç•™å¤‡ä»½ä»¥é˜²æ›´æ–°å¤±è´¥                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. é‡å‘½åæ–°ç‰ˆæœ¬                                               â”‚
â”‚    - å°† æ¥å£ç­›é€‰_v1.2.0.exe.tmp â†’ æ¥å£ç­›é€‰_v1.2.0.exe         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. åˆ›å»ºæ›´æ–°è„šæœ¬ (update.bat)                                 â”‚
â”‚    @echo off                                                 â”‚
â”‚    echo æ­£åœ¨åº”ç”¨æ›´æ–°...                                       â”‚
â”‚    timeout /t 2 /nobreak >nul                                â”‚
â”‚    taskkill /f /im æ¥å£ç­›é€‰.exe                              â”‚
â”‚    if exist "æ¥å£ç­›é€‰_v1.2.0.exe" (                           â”‚
â”‚        move /y "æ¥å£ç­›é€‰_v1.2.0.exe" "æ¥å£ç­›é€‰.exe"           â”‚
â”‚        start "" "æ¥å£ç­›é€‰.exe" --auto                         â”‚
â”‚        del "æ¥å£ç­›é€‰.exe.backup"                              â”‚
â”‚    ) else (                                                  â”‚
â”‚        echo æ›´æ–°å¤±è´¥ï¼Œæ¢å¤å¤‡ä»½...                             â”‚
â”‚        move /y "æ¥å£ç­›é€‰.exe.backup" "æ¥å£ç­›é€‰.exe"           â”‚
â”‚        start "" "æ¥å£ç­›é€‰.exe"                                â”‚
â”‚    )                                                         â”‚
â”‚    del update.bat                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. è¯¢é—®ç”¨æˆ·æ˜¯å¦ç«‹å³é‡å¯                                       â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ æ›´æ–°æˆåŠŸ                                           â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ ç‰ˆæœ¬ v1.2.0 ä¸‹è½½å®Œæˆï¼                            â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚ æ˜¯å¦ç«‹å³é‡å¯åº”ç”¨æ›´æ–°ï¼Ÿ                             â”‚    â”‚
â”‚    â”‚ ï¼ˆé€‰æ‹©"å¦"å°†åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶ç”Ÿæ•ˆï¼‰                     â”‚    â”‚
â”‚    â”‚                                                   â”‚    â”‚
â”‚    â”‚         [æ˜¯(Y)]    [å¦(N)]                         â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é€‰æ‹©"æ˜¯" â”‚                      â”‚ é€‰æ‹©"å¦" â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9a. ç«‹å³é‡å¯      â”‚            â”‚ 9b. ç¨åé‡å¯      â”‚
â”‚ - å¯åŠ¨update.bat  â”‚            â”‚ - æ–°ç‰ˆæœ¬æ–‡ä»¶å·²å°±ä½â”‚
â”‚ - é€€å‡ºå½“å‰ç¨‹åº    â”‚            â”‚ - ä¸‹æ¬¡å¯åŠ¨æ—¶ç”Ÿæ•ˆ  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» æ ¸å¿ƒä»£ç è®¾è®¡

### æ–‡ä»¶1: version_manager.py

```python
# -*- coding: utf-8 -*-
"""
ç‰ˆæœ¬ç®¡ç†å™¨æ¨¡å—

åŠŸèƒ½ï¼š
1. ç‰ˆæœ¬æ£€æµ‹å’Œæ¯”è¾ƒ
2. é…ç½®åŒæ­¥
3. æ–‡ä»¶ä¸‹è½½
4. æ›´æ–°åº”ç”¨
"""

import os
import sys
import json
import hashlib
import threading
import shutil
from typing import Tuple, Optional, Dict, List, Callable


class VersionManager:
    """ç‰ˆæœ¬ç®¡ç†å™¨"""
    
    # æœåŠ¡å™¨é…ç½®
    SERVER_PATH = r"\\10.102.2.7\æ–‡ä»¶æœåŠ¡å™¨\å»ºç­‘ç»“æ„æ‰€\æ¥å£æ–‡ä»¶"
    
    # å½“å‰ç‰ˆæœ¬ï¼ˆç¡¬ç¼–ç ï¼Œæ¯æ¬¡å‘å¸ƒæ—¶æ›´æ–°ï¼‰
    CURRENT_VERSION = "1.1.0"
    
    def __init__(self, config_file: str = "config.json"):
        """
        åˆå§‹åŒ–ç‰ˆæœ¬ç®¡ç†å™¨
        
        å‚æ•°:
            config_file: æœ¬åœ°é…ç½®æ–‡ä»¶è·¯å¾„
        """
        self.config_file = config_file
        self.skipped_versions: List[str] = []
        self.last_check_time: Optional[str] = None
        self.auto_check_update: bool = True
        
        # åŠ è½½æœ¬åœ°é…ç½®
        self._load_config()
    
    def _load_config(self):
        """åŠ è½½æœ¬åœ°é…ç½®"""
        try:
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    config = json.load(f)
                    self.skipped_versions = config.get('skipped_versions', [])
                    self.last_check_time = config.get('last_check_time')
                    self.auto_check_update = config.get('auto_check_update', True)
        except Exception as e:
            print(f"åŠ è½½é…ç½®å¤±è´¥: {e}")
    
    def _save_config(self):
        """ä¿å­˜æœ¬åœ°é…ç½®"""
        try:
            if os.path.exists(self.config_file):
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    config = json.load(f)
            else:
                config = {}
            
            config['skipped_versions'] = self.skipped_versions
            config['last_check_time'] = self.last_check_time
            config['auto_check_update'] = self.auto_check_update
            config['current_version'] = self.CURRENT_VERSION
            
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(config, f, indent=2, ensure_ascii=False)
        except Exception as e:
            print(f"ä¿å­˜é…ç½®å¤±è´¥: {e}")
    
    @staticmethod
    def compare_version(v1: str, v2: str) -> int:
        """
        æ¯”è¾ƒç‰ˆæœ¬å·
        
        å‚æ•°:
            v1: ç‰ˆæœ¬å·1 (å¦‚ "1.2.0")
            v2: ç‰ˆæœ¬å·2 (å¦‚ "1.1.0")
        
        è¿”å›:
            1: v1 > v2
            0: v1 == v2
           -1: v1 < v2
        """
        try:
            parts1 = [int(x) for x in v1.split('.')]
            parts2 = [int(x) for x in v2.split('.')]
            
            # è¡¥é½é•¿åº¦
            max_len = max(len(parts1), len(parts2))
            parts1.extend([0] * (max_len - len(parts1)))
            parts2.extend([0] * (max_len - len(parts2)))
            
            for p1, p2 in zip(parts1, parts2):
                if p1 > p2:
                    return 1
                elif p1 < p2:
                    return -1
            return 0
        except Exception as e:
            print(f"ç‰ˆæœ¬æ¯”è¾ƒå¤±è´¥: {e}")
            return 0
    
    def check_server_accessible(self, timeout: int = 3) -> bool:
        """
        æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
        
        å‚æ•°:
            timeout: è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
        
        è¿”å›:
            True: å¯è®¿é—®
            False: ä¸å¯è®¿é—®
        """
        result = [False]
        
        def check():
            try:
                version_file = os.path.join(self.SERVER_PATH, "version.json")
                result[0] = os.path.exists(version_file)
            except Exception as e:
                print(f"æ£€æŸ¥æœåŠ¡å™¨å¯è®¿é—®æ€§å¤±è´¥: {e}")
                result[0] = False
        
        thread = threading.Thread(target=check, daemon=True)
        thread.start()
        thread.join(timeout)
        
        return result[0]
    
    def get_server_version_info(self) -> Optional[Dict]:
        """
        ä»æœåŠ¡å™¨è·å–ç‰ˆæœ¬ä¿¡æ¯
        
        è¿”å›:
            ç‰ˆæœ¬ä¿¡æ¯å­—å…¸ï¼Œå¤±è´¥è¿”å›None
        """
        try:
            version_file = os.path.join(self.SERVER_PATH, "version.json")
            
            if not os.path.exists(version_file):
                print(f"æœåŠ¡å™¨ç‰ˆæœ¬æ–‡ä»¶ä¸å­˜åœ¨: {version_file}")
                return None
            
            with open(version_file, 'r', encoding='utf-8') as f:
                version_info = json.load(f)
            
            # éªŒè¯å¿…è¦å­—æ®µ
            required_fields = ['version', 'exe_filename', 'md5_hash']
            for field in required_fields:
                if field not in version_info:
                    print(f"ç‰ˆæœ¬ä¿¡æ¯ç¼ºå°‘å¿…è¦å­—æ®µ: {field}")
                    return None
            
            return version_info
        except Exception as e:
            print(f"è¯»å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯å¤±è´¥: {e}")
            return None
    
    def check_update(self, silent: bool = False) -> Tuple[bool, Optional[Dict]]:
        """
        æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°
        
        å‚æ•°:
            silent: æ˜¯å¦é™é»˜æ£€æŸ¥ï¼ˆä¸è®°å½•æ—¥å¿—ï¼‰
        
        è¿”å›:
            (has_update, version_info)
            - has_update: æ˜¯å¦æœ‰æ›´æ–°
            - version_info: ç‰ˆæœ¬ä¿¡æ¯ï¼ˆæœ‰æ›´æ–°æ—¶ï¼‰
        """
        try:
            # æ£€æŸ¥æœåŠ¡å™¨å¯è®¿é—®æ€§
            if not self.check_server_accessible():
                if not silent:
                    print("æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨")
                return False, None
            
            # è·å–æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯
            server_version_info = self.get_server_version_info()
            if not server_version_info:
                return False, None
            
            server_version = server_version_info['version']
            
            # æ¯”è¾ƒç‰ˆæœ¬
            compare_result = self.compare_version(server_version, self.CURRENT_VERSION)
            
            if compare_result > 0:
                # æœåŠ¡å™¨ç‰ˆæœ¬æ›´æ–°
                if not silent:
                    print(f"æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬: {server_version} (å½“å‰: {self.CURRENT_VERSION})")
                return True, server_version_info
            else:
                if not silent:
                    print(f"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬: {self.CURRENT_VERSION}")
                return False, None
        
        except Exception as e:
            print(f"æ£€æŸ¥æ›´æ–°å¤±è´¥: {e}")
            return False, None
    
    def download_update(self, 
                       version_info: Dict, 
                       progress_callback: Optional[Callable[[int, int], None]] = None) -> str:
        """
        ä¸‹è½½æ›´æ–°æ–‡ä»¶
        
        å‚æ•°:
            version_info: ç‰ˆæœ¬ä¿¡æ¯
            progress_callback: è¿›åº¦å›è°ƒå‡½æ•° (current_bytes, total_bytes)
        
        è¿”å›:
            ä¸‹è½½æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„
        
        å¼‚å¸¸:
            Exception: ä¸‹è½½å¤±è´¥
        """
        try:
            # æºæ–‡ä»¶è·¯å¾„
            exe_filename = version_info['exe_filename']
            source_path = os.path.join(self.SERVER_PATH, exe_filename)
            
            if not os.path.exists(source_path):
                raise FileNotFoundError(f"æœåŠ¡å™¨æ–‡ä»¶ä¸å­˜åœ¨: {source_path}")
            
            # ç›®æ ‡ä¸´æ—¶æ–‡ä»¶è·¯å¾„
            dest_path = os.path.join(os.getcwd(), f"{exe_filename}.tmp")
            
            # è·å–æ–‡ä»¶å¤§å°
            file_size = os.path.getsize(source_path)
            
            # ä¸‹è½½æ–‡ä»¶
            chunk_size = 1024 * 1024  # 1MB
            copied = 0
            
            with open(source_path, 'rb') as src, open(dest_path, 'wb') as dst:
                while True:
                    chunk = src.read(chunk_size)
                    if not chunk:
                        break
                    dst.write(chunk)
                    copied += len(chunk)
                    
                    # å›è°ƒè¿›åº¦
                    if progress_callback:
                        progress_callback(copied, file_size)
            
            # éªŒè¯MD5
            expected_md5 = version_info['md5_hash']
            actual_md5 = self._calculate_md5(dest_path)
            
            if actual_md5 != expected_md5:
                os.remove(dest_path)
                raise ValueError(f"æ–‡ä»¶æ ¡éªŒå¤±è´¥: MD5ä¸åŒ¹é…")
            
            # é‡å‘½åä¸ºæ­£å¼æ–‡ä»¶å
            final_path = dest_path.replace('.tmp', '')
            if os.path.exists(final_path):
                os.remove(final_path)
            os.rename(dest_path, final_path)
            
            print(f"ä¸‹è½½å®Œæˆ: {final_path}")
            return final_path
        
        except Exception as e:
            print(f"ä¸‹è½½æ›´æ–°å¤±è´¥: {e}")
            raise
    
    @staticmethod
    def _calculate_md5(file_path: str) -> str:
        """è®¡ç®—æ–‡ä»¶MD5"""
        md5 = hashlib.md5()
        with open(file_path, 'rb') as f:
            for chunk in iter(lambda: f.read(4096), b""):
                md5.update(chunk)
        return md5.hexdigest()
    
    def apply_update(self, new_exe_path: str):
        """
        åº”ç”¨æ›´æ–°ï¼ˆåˆ›å»ºbatè„šæœ¬å¹¶å¯åŠ¨ï¼‰
        
        å‚æ•°:
            new_exe_path: æ–°ç‰ˆæœ¬exeçš„è·¯å¾„
        """
        try:
            current_exe = sys.executable if getattr(sys, 'frozen', False) else "æ¥å£ç­›é€‰.exe"
            current_exe_backup = f"{current_exe}.backup"
            
            # åˆ›å»ºæ›´æ–°è„šæœ¬
            bat_content = f"""@echo off
echo æ­£åœ¨åº”ç”¨æ›´æ–°...
timeout /t 2 /nobreak >nul

taskkill /f /im "{os.path.basename(current_exe)}" 2>nul

if exist "{new_exe_path}" (
    echo å¤‡ä»½å½“å‰ç‰ˆæœ¬...
    if exist "{current_exe}" (
        move /y "{current_exe}" "{current_exe_backup}"
    )
    
    echo å®‰è£…æ–°ç‰ˆæœ¬...
    move /y "{new_exe_path}" "{current_exe}"
    
    if exist "{current_exe}" (
        echo æ›´æ–°æˆåŠŸï¼å¯åŠ¨æ–°ç‰ˆæœ¬...
        start "" "{current_exe}" --auto
        del "{current_exe_backup}" 2>nul
    ) else (
        echo æ›´æ–°å¤±è´¥ï¼Œæ¢å¤å¤‡ä»½...
        move /y "{current_exe_backup}" "{current_exe}"
        start "" "{current_exe}"
    )
) else (
    echo æ–°ç‰ˆæœ¬æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå–æ¶ˆæ›´æ–°
    if exist "{current_exe_backup}" (
        move /y "{current_exe_backup}" "{current_exe}"
    )
    start "" "{current_exe}"
)

del update.bat
"""
            
            bat_path = "update.bat"
            with open(bat_path, 'w', encoding='gbk') as f:
                f.write(bat_content)
            
            # å¯åŠ¨batè„šæœ¬
            os.startfile(bat_path)
            print("æ›´æ–°è„šæœ¬å·²å¯åŠ¨")
        
        except Exception as e:
            print(f"åº”ç”¨æ›´æ–°å¤±è´¥: {e}")
            raise
    
    def skip_version(self, version: str):
        """
        è·³è¿‡æŒ‡å®šç‰ˆæœ¬
        
        å‚æ•°:
            version: è¦è·³è¿‡çš„ç‰ˆæœ¬å·
        """
        if version not in self.skipped_versions:
            self.skipped_versions.append(version)
            self._save_config()
            print(f"å·²è·³è¿‡ç‰ˆæœ¬: {version}")
    
    def sync_config_from_server(self) -> bool:
        """
        ä»æœåŠ¡å™¨åŒæ­¥é…ç½®
        
        è¿”å›:
            True: åŒæ­¥æˆåŠŸ
            False: åŒæ­¥å¤±è´¥
        """
        try:
            config_file = os.path.join(self.SERVER_PATH, "config.json")
            
            if not os.path.exists(config_file):
                print("æœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¸å­˜åœ¨")
                return False
            
            with open(config_file, 'r', encoding='utf-8') as f:
                server_config = json.load(f)
            
            # åªåŒæ­¥shared_settingséƒ¨åˆ†
            shared_settings = server_config.get('shared_settings', {})
            
            if shared_settings:
                # æ›´æ–°æœ¬åœ°é…ç½®ï¼ˆä¸è¦†ç›–ç”¨æˆ·ä¸ªäººè®¾ç½®ï¼‰
                if os.path.exists(self.config_file):
                    with open(self.config_file, 'r', encoding='utf-8') as f:
                        local_config = json.load(f)
                else:
                    local_config = {}
                
                # åˆå¹¶é…ç½®
                for key, value in shared_settings.items():
                    local_config[key] = value
                
                with open(self.config_file, 'w', encoding='utf-8') as f:
                    json.dump(local_config, f, indent=2, ensure_ascii=False)
                
                print("é…ç½®åŒæ­¥æˆåŠŸ")
                return True
            
            return False
        
        except Exception as e:
            print(f"åŒæ­¥é…ç½®å¤±è´¥: {e}")
            return False
```

---

### æ–‡ä»¶2: update_dialog.py

```python
# -*- coding: utf-8 -*-
"""
æ›´æ–°å¯¹è¯æ¡†æ¨¡å—
"""

import tkinter as tk
from tkinter import ttk
from typing import Optional, Dict


class UpdateDialog:
    """æ›´æ–°æç¤ºå¯¹è¯æ¡†"""
    
    def __init__(self, parent, version_info: Dict):
        """
        åˆå§‹åŒ–æ›´æ–°å¯¹è¯æ¡†
        
        å‚æ•°:
            parent: çˆ¶çª—å£
            version_info: ç‰ˆæœ¬ä¿¡æ¯
        """
        self.parent = parent
        self.version_info = version_info
        self.result = "later"  # update / skip / later
        self.skip_this_version = False
        
        self.dialog = tk.Toplevel(parent)
        self.dialog.title("æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬")
        self.dialog.geometry("500x400")
        self.dialog.transient(parent)
        self.dialog.grab_set()
        self.dialog.resizable(False, False)
        
        self._create_widgets()
        
        # å±…ä¸­æ˜¾ç¤º
        self._center_window()
    
    def _center_window(self):
        """çª—å£å±…ä¸­"""
        self.dialog.update_idletasks()
        x = self.parent.winfo_rootx() + (self.parent.winfo_width() // 2) - (self.dialog.winfo_width() // 2)
        y = self.parent.winfo_rooty() + (self.parent.winfo_height() // 2) - (self.dialog.winfo_height() // 2)
        self.dialog.geometry(f"+{x}+{y}")
    
    def _create_widgets(self):
        """åˆ›å»ºç•Œé¢ç»„ä»¶"""
        # ä¸»æ¡†æ¶
        main_frame = ttk.Frame(self.dialog, padding="20")
        main_frame.pack(fill=tk.BOTH, expand=True)
        
        # æ ‡é¢˜
        title_label = ttk.Label(main_frame, 
                                text="ğŸ‰ æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼", 
                                font=("", 14, "bold"))
        title_label.pack(pady=(0, 15))
        
        # ç‰ˆæœ¬ä¿¡æ¯æ¡†æ¶
        info_frame = ttk.Frame(main_frame)
        info_frame.pack(fill=tk.X, pady=(0, 15))
        
        from version_manager import VersionManager
        current_version = VersionManager.CURRENT_VERSION
        new_version = self.version_info.get('version', 'Unknown')
        release_date = self.version_info.get('release_date', 'Unknown')
        
        ttk.Label(info_frame, text=f"å½“å‰ç‰ˆæœ¬: v{current_version}").pack(anchor=tk.W)
        ttk.Label(info_frame, text=f"æœ€æ–°ç‰ˆæœ¬: v{new_version}", 
                 font=("", 10, "bold"), foreground="green").pack(anchor=tk.W)
        ttk.Label(info_frame, text=f"å‘å¸ƒæ—¥æœŸ: {release_date}").pack(anchor=tk.W)
        
        # æ›´æ–°å†…å®¹
        changelog_frame = ttk.LabelFrame(main_frame, text="æ›´æ–°å†…å®¹", padding="10")
        changelog_frame.pack(fill=tk.BOTH, expand=True, pady=(0, 15))
        
        changelog_text = tk.Text(changelog_frame, height=10, wrap=tk.WORD, 
                                 relief=tk.FLAT, bg="#f0f0f0")
        changelog_text.pack(fill=tk.BOTH, expand=True)
        
        changelog = self.version_info.get('changelog', 'æš‚æ— æ›´æ–°è¯´æ˜')
        changelog_text.insert('1.0', changelog)
        changelog_text.config(state=tk.DISABLED)
        
        # è·³è¿‡ç‰ˆæœ¬å¤é€‰æ¡†
        self.skip_var = tk.BooleanVar(value=False)
        skip_check = ttk.Checkbutton(main_frame, 
                                     text="ä¸å†æé†’æ­¤ç‰ˆæœ¬", 
                                     variable=self.skip_var)
        skip_check.pack(anchor=tk.W, pady=(0, 15))
        
        # æŒ‰é’®æ¡†æ¶
        button_frame = ttk.Frame(main_frame)
        button_frame.pack(fill=tk.X)
        
        ttk.Button(button_frame, text="ç«‹å³æ›´æ–°", 
                  command=self._on_update, 
                  width=12).pack(side=tk.LEFT, padx=(0, 5))
        
        ttk.Button(button_frame, text="è·³è¿‡æ­¤ç‰ˆæœ¬", 
                  command=self._on_skip, 
                  width=12).pack(side=tk.LEFT, padx=5)
        
        ttk.Button(button_frame, text="ç¨åæé†’", 
                  command=self._on_later, 
                  width=12).pack(side=tk.LEFT, padx=(5, 0))
    
    def _on_update(self):
        """ç‚¹å‡»"ç«‹å³æ›´æ–°"æŒ‰é’®"""
        self.result = "update"
        self.skip_this_version = self.skip_var.get()
        self.dialog.destroy()
    
    def _on_skip(self):
        """ç‚¹å‡»"è·³è¿‡æ­¤ç‰ˆæœ¬"æŒ‰é’®"""
        self.result = "skip"
        self.skip_this_version = True  # å¼ºåˆ¶è·³è¿‡
        self.dialog.destroy()
    
    def _on_later(self):
        """ç‚¹å‡»"ç¨åæé†’"æŒ‰é’®"""
        self.result = "later"
        self.skip_this_version = self.skip_var.get()
        self.dialog.destroy()
    
    def show(self) -> str:
        """
        æ˜¾ç¤ºå¯¹è¯æ¡†å¹¶ç­‰å¾…ç”¨æˆ·é€‰æ‹©
        
        è¿”å›:
            "update" / "skip" / "later"
        """
        self.dialog.wait_window()
        
        # å¦‚æœå‹¾é€‰äº†"ä¸å†æé†’"ï¼Œè¿”å›skip
        if self.skip_this_version and self.result == "later":
            self.result = "skip"
        
        return self.result


class DownloadProgressDialog:
    """ä¸‹è½½è¿›åº¦å¯¹è¯æ¡†"""
    
    def __init__(self, parent):
        """
        åˆå§‹åŒ–ä¸‹è½½è¿›åº¦å¯¹è¯æ¡†
        
        å‚æ•°:
            parent: çˆ¶çª—å£
        """
        self.parent = parent
        self.cancelled = False
        
        self.dialog = tk.Toplevel(parent)
        self.dialog.title("ä¸‹è½½æ›´æ–°")
        self.dialog.geometry("450x200")
        self.dialog.transient(parent)
        self.dialog.grab_set()
        self.dialog.resizable(False, False)
        
        # ç¦æ­¢å…³é—­çª—å£
        self.dialog.protocol("WM_DELETE_WINDOW", self._on_cancel)
        
        self._create_widgets()
        self._center_window()
    
    def _center_window(self):
        """çª—å£å±…ä¸­"""
        self.dialog.update_idletasks()
        x = self.parent.winfo_rootx() + (self.parent.winfo_width() // 2) - (self.dialog.winfo_width() // 2)
        y = self.parent.winfo_rooty() + (self.parent.winfo_height() // 2) - (self.dialog.winfo_height() // 2)
        self.dialog.geometry(f"+{x}+{y}")
    
    def _create_widgets(self):
        """åˆ›å»ºç•Œé¢ç»„ä»¶"""
        main_frame = ttk.Frame(self.dialog, padding="20")
        main_frame.pack(fill=tk.BOTH, expand=True)
        
        # æ–‡ä»¶åæ ‡ç­¾
        self.filename_label = ttk.Label(main_frame, text="æ­£åœ¨ä¸‹è½½...", 
                                       font=("", 10, "bold"))
        self.filename_label.pack(pady=(0, 15))
        
        # è¿›åº¦æ¡
        self.progress_var = tk.DoubleVar(value=0)
        self.progress_bar = ttk.Progressbar(main_frame, 
                                           variable=self.progress_var, 
                                           maximum=100, 
                                           length=400)
        self.progress_bar.pack(pady=(0, 10))
        
        # è¿›åº¦ä¿¡æ¯
        self.info_label = ttk.Label(main_frame, text="0 MB / 0 MB")
        self.info_label.pack()
        
        self.speed_label = ttk.Label(main_frame, text="é€Ÿåº¦: 0 MB/s")
        self.speed_label.pack()
        
        self.eta_label = ttk.Label(main_frame, text="å‰©ä½™æ—¶é—´: è®¡ç®—ä¸­...")
        self.eta_label.pack()
        
        # å–æ¶ˆæŒ‰é’®
        ttk.Button(main_frame, text="å–æ¶ˆä¸‹è½½", 
                  command=self._on_cancel).pack(pady=(15, 0))
        
        self.last_update_time = None
        self.last_bytes = 0
    
    def update_progress(self, current_bytes: int, total_bytes: int):
        """
        æ›´æ–°è¿›åº¦
        
        å‚æ•°:
            current_bytes: å·²ä¸‹è½½å­—èŠ‚æ•°
            total_bytes: æ€»å­—èŠ‚æ•°
        """
        import time
        
        # æ›´æ–°è¿›åº¦æ¡
        progress = (current_bytes / total_bytes) * 100 if total_bytes > 0 else 0
        self.progress_var.set(progress)
        
        # æ›´æ–°æ–‡ä»¶å¤§å°ä¿¡æ¯
        current_mb = current_bytes / (1024 * 1024)
        total_mb = total_bytes / (1024 * 1024)
        self.info_label.config(text=f"{current_mb:.1f} MB / {total_mb:.1f} MB")
        
        # è®¡ç®—é€Ÿåº¦
        current_time = time.time()
        if self.last_update_time:
            time_diff = current_time - self.last_update_time
            if time_diff > 0:
                bytes_diff = current_bytes - self.last_bytes
                speed_mbps = (bytes_diff / time_diff) / (1024 * 1024)
                self.speed_label.config(text=f"é€Ÿåº¦: {speed_mbps:.1f} MB/s")
                
                # è®¡ç®—å‰©ä½™æ—¶é—´
                if speed_mbps > 0:
                    remaining_bytes = total_bytes - current_bytes
                    eta_seconds = remaining_bytes / (speed_mbps * 1024 * 1024)
                    if eta_seconds < 60:
                        eta_text = f"å‰©ä½™æ—¶é—´: çº¦ {int(eta_seconds)} ç§’"
                    else:
                        eta_minutes = int(eta_seconds / 60)
                        eta_text = f"å‰©ä½™æ—¶é—´: çº¦ {eta_minutes} åˆ†é’Ÿ"
                    self.eta_label.config(text=eta_text)
        
        self.last_update_time = current_time
        self.last_bytes = current_bytes
        
        # æ›´æ–°ç•Œé¢
        self.dialog.update()
    
    def _on_cancel(self):
        """å–æ¶ˆä¸‹è½½"""
        self.cancelled = True
        self.dialog.destroy()
    
    def close(self):
        """å…³é—­å¯¹è¯æ¡†"""
        try:
            self.dialog.destroy()
        except:
            pass
```

---

### æ–‡ä»¶3: base.pyï¼ˆä¿®æ”¹éƒ¨åˆ†ï¼‰

```python
# åœ¨ ExcelProcessorApp.__init__ ä¸­æ·»åŠ 

def __init__(self, auto_mode: bool = False):
    self.auto_mode = auto_mode
    
    # ... ç°æœ‰åˆå§‹åŒ–ä»£ç  ...
    
    # ===== æ–°å¢ï¼šç‰ˆæœ¬ç®¡ç†å™¨ =====
    from version_manager import VersionManager
    self.version_manager = VersionManager()
    
    # ===== æ–°å¢ï¼šå¯åŠ¨æ—¶åŒæ­¥é…ç½® =====
    try:
        self.version_manager.sync_config_from_server()
    except Exception as e:
        print(f"åŒæ­¥æœåŠ¡å™¨é…ç½®å¤±è´¥: {e}")
    
    # ===== æ–°å¢ï¼šå¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–° =====
    if not auto_mode:
        # æ™®é€šå¯åŠ¨ï¼šå»¶è¿Ÿ500msåæ£€æŸ¥ï¼ˆé¿å…é˜»å¡ç•Œé¢ï¼‰
        self.root.after(500, lambda: threading.Thread(
            target=self._check_update_on_startup, 
            daemon=True
        ).start())
    else:
        # è‡ªåŠ¨æ¨¡å¼ï¼šåœ¨è‡ªåŠ¨è¿è¡Œå‰æ£€æŸ¥
        threading.Thread(
            target=self._check_update_on_startup, 
            daemon=True
        ).start()


# ===== æ–°å¢æ–¹æ³• =====

def _check_update_on_startup(self):
    """å¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–°"""
    try:
        # æ£€æŸ¥æ›´æ–°
        has_update, version_info = self.version_manager.check_update(silent=True)
        
        if not has_update:
            return
        
        # æ£€æŸ¥æ˜¯å¦è·³è¿‡æ­¤ç‰ˆæœ¬
        if version_info["version"] in self.version_manager.skipped_versions:
            print(f"å·²è·³è¿‡ç‰ˆæœ¬ {version_info['version']}")
            return
        
        # è‡ªåŠ¨æ¨¡å¼ä¸‹çš„ç‰¹æ®Šå¤„ç†
        if self.auto_mode:
            # å¦‚æœæ˜¯å¼ºåˆ¶æ›´æ–°ï¼Œåˆ™æ˜¾ç¤ºæç¤º
            if version_info.get("force_update", False):
                # åœ¨ä¸»çº¿ç¨‹ä¸­æ˜¾ç¤ºå¯¹è¯æ¡†
                self.root.after(0, lambda: self._show_update_dialog(version_info))
            else:
                # éå¼ºåˆ¶æ›´æ–°ï¼Œè®°å½•æ—¥å¿—å¹¶ç»§ç»­
                print(f"æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ {version_info['version']}ï¼Œè‡ªåŠ¨æ¨¡å¼ä¸‹å·²è·³è¿‡")
            return
        
        # æ™®é€šæ¨¡å¼ï¼šåœ¨ä¸»çº¿ç¨‹ä¸­æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
        self.root.after(0, lambda: self._show_update_dialog(version_info))
    
    except Exception as e:
        print(f"æ£€æŸ¥æ›´æ–°å¤±è´¥: {e}")


def _show_update_dialog(self, version_info):
    """æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†"""
    try:
        from update_dialog import UpdateDialog
        dialog = UpdateDialog(self.root, version_info)
        choice = dialog.show()
        
        if choice == "update":
            self._do_update(version_info)
        elif choice == "skip":
            self.version_manager.skip_version(version_info["version"])
    except Exception as e:
        print(f"æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†å¤±è´¥: {e}")


def _manual_check_update(self):
    """æ‰‹åŠ¨æ£€æŸ¥æ›´æ–°"""
    # æ˜¾ç¤º"æ£€æŸ¥ä¸­"æç¤º
    checking_dialog = self.show_waiting_dialog("æ£€æŸ¥æ›´æ–°", "æ­£åœ¨æ£€æŸ¥æ›´æ–°...")
    
    def check_in_thread():
        try:
            has_update, version_info = self.version_manager.check_update(silent=False)
            
            # åœ¨ä¸»çº¿ç¨‹ä¸­å…³é—­"æ£€æŸ¥ä¸­"æç¤º
            if checking_dialog:
                self.root.after(0, lambda: checking_dialog[0].destroy() if checking_dialog[0].winfo_exists() else None)
            
            if has_update:
                # åœ¨ä¸»çº¿ç¨‹ä¸­æ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
                self.root.after(0, lambda: self._show_update_dialog(version_info))
            else:
                # åœ¨ä¸»çº¿ç¨‹ä¸­æ˜¾ç¤ºæç¤º
                self.root.after(0, lambda: messagebox.showinfo("æ£€æŸ¥æ›´æ–°", 
                    f"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ v{self.version_manager.CURRENT_VERSION}"))
        except Exception as e:
            if checking_dialog:
                self.root.after(0, lambda: checking_dialog[0].destroy() if checking_dialog[0].winfo_exists() else None)
            
            self.root.after(0, lambda: messagebox.showerror("æ£€æŸ¥æ›´æ–°å¤±è´¥", 
                f"æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨æˆ–æ£€æŸ¥æ›´æ–°å¤±è´¥ï¼š\n{e}"))
    
    # åœ¨åå°çº¿ç¨‹æ£€æŸ¥
    threading.Thread(target=check_in_thread, daemon=True).start()


def _do_update(self, version_info):
    """æ‰§è¡Œæ›´æ–°"""
    try:
        from update_dialog import DownloadProgressDialog
        
        # æ˜¾ç¤ºä¸‹è½½è¿›åº¦å¯¹è¯æ¡†
        progress_dialog = DownloadProgressDialog(self.root)
        
        def progress_callback(current, total):
            self.root.after(0, lambda: progress_dialog.update_progress(current, total))
        
        # åœ¨åå°çº¿ç¨‹ä¸‹è½½
        def download_in_thread():
            try:
                exe_path = self.version_manager.download_update(
                    version_info, 
                    progress_callback=progress_callback
                )
                
                # åœ¨ä¸»çº¿ç¨‹ä¸­å…³é—­è¿›åº¦å¯¹è¯æ¡†
                self.root.after(0, lambda: progress_dialog.close())
                
                # åœ¨ä¸»çº¿ç¨‹ä¸­è¯¢é—®æ˜¯å¦é‡å¯
                def ask_restart():
                    result = messagebox.askyesno("æ›´æ–°æˆåŠŸ", 
                        f"ç‰ˆæœ¬ {version_info['version']} ä¸‹è½½å®Œæˆï¼\n\n"
                        "æ˜¯å¦ç«‹å³é‡å¯åº”ç”¨æ›´æ–°ï¼Ÿ\n"
                        "ï¼ˆé€‰æ‹©"å¦"å°†åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶ç”Ÿæ•ˆï¼‰")
                    
                    if result:
                        # åº”ç”¨æ›´æ–°å¹¶é€€å‡º
                        self.version_manager.apply_update(exe_path)
                        self.root.destroy()
                        sys.exit(0)
                
                self.root.after(0, ask_restart)
            
            except Exception as e:
                self.root.after(0, lambda: progress_dialog.close())
                self.root.after(0, lambda: messagebox.showerror("æ›´æ–°å¤±è´¥", 
                    f"ä¸‹è½½æˆ–å®‰è£…æ›´æ–°å¤±è´¥ï¼š\n{e}"))
        
        threading.Thread(target=download_in_thread, daemon=True).start()
    
    except Exception as e:
        messagebox.showerror("æ›´æ–°å¤±è´¥", f"æ›´æ–°è¿‡ç¨‹å¤±è´¥ï¼š\n{e}")


# ===== ä¿®æ”¹ show_settings_menu æ–¹æ³• =====

def show_settings_menu(self):
    # ... ç°æœ‰ä»£ç  ...
    
    # ===== æ–°å¢ï¼š"æ£€æŸ¥æ›´æ–°"æŒ‰é’® =====
    update_button = ttk.Button(frame, text="æ£€æŸ¥æ›´æ–°", 
                               command=self._manual_check_update, width=14)
    update_button.pack(pady=(5, 0))
    
    # æ¸…é™¤ç¼“å­˜æŒ‰é’®
    cache_button = ttk.Button(frame, text="æ¸…é™¤ç¼“å­˜", 
                              command=on_clear_cache, width=14)
    cache_button.pack(pady=(5, 0))
    
    # å…³é—­æŒ‰é’®
    close_button = ttk.Button(frame, text="ç¡®å®š", 
                              command=settings_menu.destroy, width=14)
    close_button.pack(pady=(5, 0))
```

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. æœåŠ¡å™¨è·¯å¾„è®¿é—®

**é—®é¢˜**: Windows UNCè·¯å¾„è®¿é—®å¯èƒ½éœ€è¦ç½‘ç»œå‡­æ®

**è§£å†³æ–¹æ¡ˆ**:
- ç¡®ä¿æœåŠ¡å™¨å…±äº«æ–‡ä»¶å¤¹å¯¹æ‰€æœ‰ç”¨æˆ·å¼€æ”¾è¯»å–æƒé™
- æµ‹è¯•è·¯å¾„ï¼šåœ¨Windowsèµ„æºç®¡ç†å™¨ä¸­è¾“å…¥ `\\10.102.2.7\æ–‡ä»¶æœåŠ¡å™¨\å»ºç­‘ç»“æ„æ‰€\æ¥å£æ–‡ä»¶\` ç¡®è®¤å¯è®¿é—®
- å¦‚éœ€å¯†ç ï¼Œå»ºè®®é…ç½®åŸŸè´¦æˆ·è‡ªåŠ¨ç™»å½•

---

### 2. ç‰ˆæœ¬å·ç®¡ç†

**ç¡¬ç¼–ç ä½ç½®**: `version_manager.py` çš„ `CURRENT_VERSION`

**å‘å¸ƒæµç¨‹**:
1. ä¿®æ”¹ `CURRENT_VERSION = "1.2.0"`
2. æ‰“åŒ…ç¨‹åº
3. è®¡ç®—æ–°exeçš„MD5
4. æ›´æ–°æœåŠ¡å™¨çš„ `version.json`
5. ä¸Šä¼ æ–°exeåˆ°æœåŠ¡å™¨

---

### 3. æ›´æ–°å¤±è´¥å›æ»š

**å®‰å…¨æœºåˆ¶**:
- ä¸‹è½½å‰å¤‡ä»½å½“å‰ç‰ˆæœ¬ï¼ˆ`.backup`åç¼€ï¼‰
- MD5æ ¡éªŒå¤±è´¥è‡ªåŠ¨åˆ é™¤ä¸´æ—¶æ–‡ä»¶
- `update.bat` ä¸­åŒ…å«å›æ»šé€»è¾‘
- å¦‚æœæ–°ç‰ˆæœ¬å¯åŠ¨å¤±è´¥ï¼Œæ‰‹åŠ¨è¿è¡Œ `.backup` æ–‡ä»¶

---

### 4. è‡ªåŠ¨æ¨¡å¼ä¸‹çš„æ›´æ–°

**ç­–ç•¥**:
- é»˜è®¤è·³è¿‡éå¼ºåˆ¶æ›´æ–°
- å¼ºåˆ¶æ›´æ–°ï¼ˆ`force_update: true`ï¼‰æ—¶æ˜¾ç¤ºæç¤º
- ä¸é˜»å¡è‡ªåŠ¨è¿è¡Œæµç¨‹
- è®°å½•æ—¥å¿—ä¾›æŸ¥çœ‹

---

### 5. ç½‘ç»œè¶…æ—¶å¤„ç†

**è¶…æ—¶è®¾ç½®**:
- è‡ªåŠ¨æ£€æŸ¥ï¼š3ç§’è¶…æ—¶
- æ‰‹åŠ¨æ£€æŸ¥ï¼š5ç§’è¶…æ—¶
- æ–‡ä»¶ä¸‹è½½ï¼šæ— è¶…æ—¶ï¼ˆæ˜¾ç¤ºè¿›åº¦ï¼‰

**å¤±è´¥å¤„ç†**:
- ä¸å¼¹çª—æŠ¥é”™ï¼ˆè‡ªåŠ¨æ£€æŸ¥ï¼‰
- è®°å½•æ—¥å¿—
- ä¸å½±å“ç¨‹åºæ­£å¸¸è¿è¡Œ

---

### 6. å¹¶å‘è®¿é—®

**é—®é¢˜**: å¤šä¸ªç”¨æˆ·åŒæ—¶ä¸‹è½½åŒä¸€ä¸ªæ–‡ä»¶

**å½±å“**: æœåŠ¡å™¨å¸¦å®½å¯èƒ½é¥±å’Œ

**å»ºè®®**:
- åˆ†æ‰¹é€šçŸ¥ç”¨æˆ·æ›´æ–°
- æˆ–åœ¨ `version.json` ä¸­è®¾ç½® `release_date`ï¼Œä¸åŒç”¨æˆ·åœ¨ä¸åŒå¤©æ£€æŸ¥æ›´æ–°

---

### 7. é…ç½®åŒæ­¥ç­–ç•¥

**å½“å‰æ–¹æ¡ˆ**: åªåŒæ­¥ `shared_settings` éƒ¨åˆ†

**ä¼˜ç‚¹**: ä¸è¦†ç›–ç”¨æˆ·ä¸ªäººé…ç½®

**ç¤ºä¾‹**:
```json
// æœåŠ¡å™¨ config.json
{
  "shared_settings": {
    "server_role_table_path": "..."
  }
}

// å®¢æˆ·ç«¯ config.jsonï¼ˆåˆå¹¶åï¼‰
{
  "folder_path": "D:/...",  // ç”¨æˆ·ä¸ªäººé…ç½®ï¼Œä¿ç•™
  "user_name": "å¼ ä¸‰",      // ç”¨æˆ·ä¸ªäººé…ç½®ï¼Œä¿ç•™
  "server_role_table_path": "..."  // ä»æœåŠ¡å™¨åŒæ­¥
}
```

---

### 8. æ‰“åŒ…é…ç½®æ›´æ–°

**excel_processor.spec éœ€è¦æ·»åŠ **:
```python
datas=[
    # ... ç°æœ‰æ–‡ä»¶ ...
    ('version_manager.py', '.'),
    ('update_dialog.py', '.'),
],

hiddenimports=[
    # ... ç°æœ‰å¯¼å…¥ ...
    'version_manager',
    'update_dialog',
],
```

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### æµ‹è¯•æ¸…å•

- [ ] **åœºæ™¯1**: é¦–æ¬¡å¯åŠ¨ï¼ŒæœåŠ¡å™¨æœ‰æ–°ç‰ˆæœ¬ï¼ˆæ™®é€šæ¨¡å¼ï¼‰
  - é¢„æœŸï¼šå»¶è¿Ÿ500msåæ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
  
- [ ] **åœºæ™¯2**: é¦–æ¬¡å¯åŠ¨ï¼ŒæœåŠ¡å™¨æœ‰æ–°ç‰ˆæœ¬ï¼ˆè‡ªåŠ¨æ¨¡å¼ï¼‰
  - é¢„æœŸï¼šä¸æ˜¾ç¤ºæç¤ºï¼Œè®°å½•æ—¥å¿—ï¼Œç»§ç»­è‡ªåŠ¨è¿è¡Œ
  
- [ ] **åœºæ™¯3**: é¦–æ¬¡å¯åŠ¨ï¼ŒæœåŠ¡å™¨æ— æ–°ç‰ˆæœ¬
  - é¢„æœŸï¼šæ— æç¤ºï¼Œæ­£å¸¸è¿è¡Œ
  
- [ ] **åœºæ™¯4**: é¦–æ¬¡å¯åŠ¨ï¼ŒæœåŠ¡å™¨ä¸å¯è¾¾
  - é¢„æœŸï¼š3ç§’è¶…æ—¶ï¼Œæ— æç¤ºï¼Œæ­£å¸¸è¿è¡Œ
  
- [ ] **åœºæ™¯5**: æ‰‹åŠ¨ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"ï¼Œæœ‰æ–°ç‰ˆæœ¬
  - é¢„æœŸï¼šæ˜¾ç¤ºæ›´æ–°å¯¹è¯æ¡†
  
- [ ] **åœºæ™¯6**: æ‰‹åŠ¨ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"ï¼Œæ— æ–°ç‰ˆæœ¬
  - é¢„æœŸï¼šæç¤º"å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬"
  
- [ ] **åœºæ™¯7**: æ‰‹åŠ¨ç‚¹å‡»"æ£€æŸ¥æ›´æ–°"ï¼ŒæœåŠ¡å™¨ä¸å¯è¾¾
  - é¢„æœŸï¼š5ç§’åæç¤º"æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨"
  
- [ ] **åœºæ™¯8**: ç”¨æˆ·é€‰æ‹©"è·³è¿‡æ­¤ç‰ˆæœ¬"
  - é¢„æœŸï¼šç‰ˆæœ¬æ·»åŠ åˆ° `skipped_versions`ï¼Œä¸‹æ¬¡å¯åŠ¨ä¸å†æç¤º
  
- [ ] **åœºæ™¯9**: è·³è¿‡ç‰ˆæœ¬åï¼ŒæœåŠ¡å™¨å‘å¸ƒæ›´æ–°ç‰ˆæœ¬
  - é¢„æœŸï¼šå†æ¬¡æ˜¾ç¤ºæ›´æ–°æç¤º
  
- [ ] **åœºæ™¯10**: ä¸‹è½½æ›´æ–°ï¼ŒMD5æ ¡éªŒå¤±è´¥
  - é¢„æœŸï¼šæç¤º"æ–‡ä»¶æ ¡éªŒå¤±è´¥"ï¼Œåˆ é™¤ä¸´æ—¶æ–‡ä»¶
  
- [ ] **åœºæ™¯11**: ä¸‹è½½æ›´æ–°ï¼Œç”¨æˆ·ä¸­é€”å–æ¶ˆ
  - é¢„æœŸï¼šåˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œç»§ç»­è¿è¡Œ
  
- [ ] **åœºæ™¯12**: åº”ç”¨æ›´æ–°ï¼Œç«‹å³é‡å¯
  - é¢„æœŸï¼šå¯åŠ¨ update.batï¼Œç¨‹åºé€€å‡ºï¼Œæ–°ç‰ˆæœ¬å¯åŠ¨
  
- [ ] **åœºæ™¯13**: åº”ç”¨æ›´æ–°ï¼Œç¨åé‡å¯
  - é¢„æœŸï¼šæ–°ç‰ˆæœ¬æ–‡ä»¶å°±ä½ï¼Œä¸‹æ¬¡æ‰‹åŠ¨å¯åŠ¨æ—¶ç”Ÿæ•ˆ
  
- [ ] **åœºæ™¯14**: é…ç½®åŒæ­¥åŠŸèƒ½
  - é¢„æœŸï¼šæœåŠ¡å™¨é…ç½®åˆå¹¶åˆ°æœ¬åœ°ï¼Œä¸è¦†ç›–ç”¨æˆ·ä¸ªäººè®¾ç½®

---

## ğŸ“ å¾…ç¡®è®¤é—®é¢˜

### â“ é—®é¢˜1ï¼šæœåŠ¡å™¨è·¯å¾„ç¡®è®¤

```
\\10.102.2.7\æ–‡ä»¶æœåŠ¡å™¨\å»ºç­‘ç»“æ„æ‰€\æ¥å£æ–‡ä»¶\
```

è¯·ç¡®è®¤ï¼š
- [ ] è·¯å¾„æ ¼å¼æ­£ç¡®
- [ ] æ‰€æœ‰å®¢æˆ·ç«¯éƒ½èƒ½è®¿é—®
- [ ] æœ‰è¯»å–æƒé™ï¼ˆä¸éœ€è¦å¯†ç ï¼‰

---

### â“ é—®é¢˜2ï¼šç‰ˆæœ¬å·æ ¼å¼

å»ºè®®ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼š`ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·`

ç¤ºä¾‹ï¼š
- `1.0.0` - é¦–ä¸ªæ­£å¼ç‰ˆ
- `1.1.0` - æ–°å¢åŠŸèƒ½
- `1.1.1` - Bugä¿®å¤
- `2.0.0` - é‡å¤§æ›´æ–°

**æ˜¯å¦åŒæ„ï¼Ÿ** [ ] æ˜¯ [ ] å¦ï¼ˆè¯·è¯´æ˜å…¶ä»–æ ¼å¼ï¼‰

---

### â“ é—®é¢˜3ï¼šå¼ºåˆ¶æ›´æ–°ç­–ç•¥

æ˜¯å¦éœ€è¦"å¼ºåˆ¶æ›´æ–°"åŠŸèƒ½ï¼Ÿ

**åœºæ™¯**: å‘ç°ä¸¥é‡bugï¼Œå¿…é¡»æ‰€æœ‰ç”¨æˆ·ç«‹å³æ›´æ–°

**è¡Œä¸º**: ä¸å…è®¸è·³è¿‡ï¼Œåªèƒ½"æ›´æ–°"æˆ–"é€€å‡ºç¨‹åº"

**æ˜¯å¦éœ€è¦ï¼Ÿ** [ ] æ˜¯ [ ] å¦

---

### â“ é—®é¢˜4ï¼šè‡ªåŠ¨æ¨¡å¼ä¸‹çš„æ›´æ–°è¡Œä¸º

`--auto` æ¨¡å¼å¯åŠ¨æ—¶ï¼Œå¦‚æœæ£€æµ‹åˆ°æ›´æ–°ï¼š

**é€‰é¡¹A**ï¼ˆæ¨èï¼‰: å®Œå…¨è·³è¿‡ï¼Œä¸æç¤ºï¼Œç»§ç»­è¿è¡Œ  
**é€‰é¡¹B**: è®°å½•æ—¥å¿—ï¼Œæ˜¾ç¤ºç®€çŸ­é€šçŸ¥ï¼ˆä¸é˜»å¡ï¼‰  
**é€‰é¡¹C**: æš‚åœè‡ªåŠ¨è¿è¡Œï¼Œæ˜¾ç¤ºæ›´æ–°æç¤º

**é€‰æ‹©å“ªä¸ªï¼Ÿ** [ ] A [ ] B [ ] C

---

### â“ é—®é¢˜5ï¼šé…ç½®åŒæ­¥èŒƒå›´

ä»æœåŠ¡å™¨åŒæ­¥å“ªäº›é…ç½®ï¼Ÿ

**é€‰é¡¹A**ï¼ˆæ¨èï¼‰: åªåŒæ­¥ `å§“åè§’è‰²è¡¨.xlsx` è·¯å¾„  
**é€‰é¡¹B**: åŒæ­¥ `config.json` ä¸­çš„æŒ‡å®šå­—æ®µ  
**é€‰é¡¹C**: å®Œå…¨åŒæ­¥ `config.json`ï¼ˆå¯èƒ½è¦†ç›–ç”¨æˆ·è®¾ç½®ï¼‰

**é€‰æ‹©å“ªä¸ªï¼Ÿ** [ ] A [ ] B [ ] C

---

### â“ é—®é¢˜6ï¼šæ›´æ–°æ£€æŸ¥é¢‘ç‡

**å½“å‰æ–¹æ¡ˆ**: æ¯æ¬¡ç¨‹åºå¯åŠ¨æ—¶æ£€æŸ¥

**æ˜¯å¦éœ€è¦**:
- [ ] å®šæœŸæ£€æŸ¥ï¼ˆå¦‚æ¯å¤©ä¸€æ¬¡ï¼‰
- [ ] æ‰‹åŠ¨æ£€æŸ¥ï¼ˆåªé€šè¿‡"æ£€æŸ¥æ›´æ–°"æŒ‰é’®ï¼‰
- [ ] ä¿æŒå½“å‰æ–¹æ¡ˆï¼ˆæ¯æ¬¡å¯åŠ¨æ£€æŸ¥ï¼‰

---

## ğŸ“Š å·¥ä½œé‡ä¼°ç®—

| ä»»åŠ¡ | å·¥ä½œé‡ | è¯´æ˜ |
|------|-------|------|
| version_manager.py | 4-6å°æ—¶ | æ ¸å¿ƒé€»è¾‘ï¼ˆçº¦300è¡Œï¼‰ |
| update_dialog.py | 2-3å°æ—¶ | GUIå¯¹è¯æ¡†ï¼ˆçº¦200è¡Œï¼‰ |
| é›†æˆåˆ° base.py | 2-3å°æ—¶ | 5ä¸ªé›†æˆç‚¹ |
| æœåŠ¡å™¨é…ç½®å‡†å¤‡ | 1å°æ—¶ | åˆ›å»ºversion.jsonç­‰ |
| æµ‹è¯•å’Œè°ƒè¯• | 3-4å°æ—¶ | 14ä¸ªæµ‹è¯•åœºæ™¯ |
| æ–‡æ¡£å’Œæ‰“åŒ…é…ç½® | 1å°æ—¶ | æ›´æ–°specæ–‡ä»¶ |
| **æ€»è®¡** | **13-18å°æ—¶** | **çº¦2-3ä¸ªå·¥ä½œæ—¥** |

---

## ğŸ¯ å®æ–½å»ºè®®

### çŸ­æœŸæ–¹æ¡ˆï¼ˆ1å‘¨å†…ï¼‰

**ä¼˜å…ˆçº§**: â­â­â­â­â­

åªå®ç°**é…ç½®åŒæ­¥**åŠŸèƒ½ï¼š
- ç¨‹åºå¯åŠ¨æ—¶ä»æœåŠ¡å™¨è¯»å– `å§“åè§’è‰²è¡¨.xlsx` è·¯å¾„
- å·¥ä½œé‡ï¼š2-3å°æ—¶
- ç«‹å³è§æ•ˆ

---

### ä¸­æœŸæ–¹æ¡ˆï¼ˆ2å‘¨å†…ï¼‰

**ä¼˜å…ˆçº§**: â­â­â­â­

å®ç°**å®Œæ•´è‡ªåŠ¨æ›´æ–°**åŠŸèƒ½ï¼š
- ç‰ˆæœ¬æ£€æµ‹
- æ‰‹åŠ¨æ›´æ–°
- è‡ªåŠ¨æç¤º
- è·³è¿‡ç‰ˆæœ¬
- å·¥ä½œé‡ï¼š2-3ä¸ªå·¥ä½œæ—¥

---

### é•¿æœŸæ–¹æ¡ˆï¼ˆ1æœˆå†…ï¼‰

**ä¼˜å…ˆçº§**: â­â­â­

å¢å¼ºåŠŸèƒ½ï¼š
- å¢é‡æ›´æ–°ï¼ˆåªä¸‹è½½å˜åŒ–çš„æ–‡ä»¶ï¼‰
- æ›´æ–°æ—¥å¿—ç½‘é¡µç‰ˆ
- æ›´æ–°ç»Ÿè®¡å’Œåˆ†æ
- å·¥ä½œé‡ï¼š1å‘¨

---

## ğŸ“š å‚è€ƒèµ„æ–™

### æŠ€æœ¯å‚è€ƒ

1. **Windows UNCè·¯å¾„**: `\\server\share\folder`
2. **æ‰¹å¤„ç†è„šæœ¬**: Windows Batch å‘½ä»¤
3. **MD5æ ¡éªŒ**: `hashlib.md5()`
4. **è¯­ä¹‰åŒ–ç‰ˆæœ¬**: https://semver.org/lang/zh-CN/
5. **Tkinterçº¿ç¨‹å®‰å…¨**: ä½¿ç”¨ `root.after(0, callback)` åœ¨ä¸»çº¿ç¨‹æ›´æ–°UI

---

### ç±»ä¼¼æ¡ˆä¾‹

1. **VSCode**: è‡ªåŠ¨æ£€æµ‹æ›´æ–°ï¼Œåå°ä¸‹è½½ï¼Œé‡å¯åº”ç”¨
2. **å¾®ä¿¡**: å¯åŠ¨æ—¶æ£€æŸ¥æ›´æ–°ï¼Œæç¤ºç”¨æˆ·ä¸‹è½½
3. **Electron**: ä½¿ç”¨ `electron-updater` å®ç°è‡ªåŠ¨æ›´æ–°

---

## ğŸ“… å¾…åŠäº‹é¡¹

### å¼€å‘å‰

- [ ] ç¡®è®¤æœåŠ¡å™¨è·¯å¾„å¯è®¿é—®
- [ ] ç¡®è®¤ç‰ˆæœ¬å·æ ¼å¼
- [ ] å›ç­”6ä¸ªå¾…ç¡®è®¤é—®é¢˜
- [ ] å‡†å¤‡æµ‹è¯•ç¯å¢ƒ

---

### å¼€å‘ä¸­

- [ ] åˆ›å»º version_manager.py
- [ ] åˆ›å»º update_dialog.py
- [ ] ä¿®æ”¹ base.py
- [ ] æ›´æ–° excel_processor.spec
- [ ] åˆ›å»ºæœåŠ¡å™¨ç«¯ version.json

---

### æµ‹è¯•

- [ ] å®Œæˆ14ä¸ªæµ‹è¯•åœºæ™¯
- [ ] å¤šç”¨æˆ·å¹¶å‘æµ‹è¯•
- [ ] ç½‘ç»œå¼‚å¸¸æµ‹è¯•
- [ ] å›æ»šæœºåˆ¶æµ‹è¯•

---

### éƒ¨ç½²

- [ ] æ‰“åŒ…æ–°ç‰ˆæœ¬
- [ ] ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] é€šçŸ¥ç”¨æˆ·æ›´æ–°
- [ ] ç›‘æ§æ›´æ–°æ—¥å¿—

---

## ğŸ”š æ€»ç»“

æœ¬è®¾è®¡æ–¹æ¡ˆæä¾›äº†ä¸€ä¸ª**å®Œæ•´ã€å®‰å…¨ã€ç”¨æˆ·å‹å¥½**çš„è‡ªåŠ¨æ›´æ–°è§£å†³æ–¹æ¡ˆã€‚

**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
- âœ… ä¸é˜»å¡ç¨‹åºå¯åŠ¨
- âœ… æ”¯æŒæ‰‹åŠ¨å’Œè‡ªåŠ¨æ£€æŸ¥
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œå›æ»š
- âœ… ç”¨æˆ·å¯æ§ï¼ˆè·³è¿‡ç‰ˆæœ¬ï¼‰
- âœ… é…ç½®åŒæ­¥åŠŸèƒ½
- âœ… è‡ªåŠ¨æ¨¡å¼å‹å¥½

**å»ºè®®**ï¼š
1. å…ˆå®æ–½**é…ç½®åŒæ­¥**åŠŸèƒ½ï¼ˆå·¥ä½œé‡å°ï¼Œç«‹å³è§æ•ˆï¼‰
2. å†å®æ–½**å®Œæ•´è‡ªåŠ¨æ›´æ–°**åŠŸèƒ½ï¼ˆ2-3ä¸ªå·¥ä½œæ—¥ï¼‰
3. æ ¹æ®å®é™…ä½¿ç”¨åé¦ˆï¼Œä¼˜åŒ–å’Œå¢å¼º

---

**æ–‡æ¡£çŠ¶æ€**: ğŸ“‹ è®¾è®¡å®Œæˆï¼Œå¾…ç¡®è®¤åå®æ–½  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ27æ—¥

