# æ’åºå¯¼è‡´è·¨é¡¹ç›®é”™è¯¯çš„æ ¹æœ¬ä¿®å¤

**æ—¥æœŸ**: 2025-11-10  
**é—®é¢˜ä¸¥é‡åº¦**: ğŸ”´ğŸ”´ğŸ”´ **æå…¶ä¸¥é‡ï¼ˆæ•°æ®å®‰å…¨ï¼‰**  
**å½±å“**: ç”¨æˆ·ç‚¹å‡»æ’åºåï¼Œæ•°æ®å†™å…¥åˆ°é”™è¯¯çš„é¡¹ç›®æ–‡ä»¶

---

## ğŸ› é—®é¢˜æè¿°

### ç”¨æˆ·å‘ç°çš„ç°è±¡

1. **æ’åºåæ•°æ®é”™ä¹±**ï¼š
   - ç”¨æˆ·ç‚¹å‡»è¡¨å¤´æŒ‰æ—¶é—´æ’åº
   - Treeviewæ˜¾ç¤ºé¡ºåºæ”¹å˜ï¼ˆ2016é¡¹ç›®æ¥å£æ’åˆ°ç¬¬ä¸€è¡Œï¼‰
   - ç”¨æˆ·ç‚¹å‡»ç¬¬ä¸€è¡Œå¡«å†™å›æ–‡å•å·
   - **å®é™…å†™å…¥çš„æ˜¯åŸå§‹ç¬¬ä¸€è¡Œçš„æ•°æ®ï¼ˆ1818é¡¹ç›®ï¼‰**

2. **æ¥å£å·æ˜¾ç¤ºé”™è¯¯**ï¼š
   - æ§åˆ¶å°æ˜¾ç¤ºï¼š`æ¥å£å·: ECZB-001299-EDMB(è®¾è®¡äººå‘˜)`
   - è¿™æ˜¯Treeviewæ˜¾ç¤ºçš„æ¥å£å·ï¼ˆå¸¦è§’è‰²åç¼€ï¼‰
   - ä½†å®é™…å†™å…¥æ•°æ®çš„æ˜¯å¦ä¸€ä¸ªæ¥å£ï¼ˆ1818é¡¹ç›®ï¼‰

3. **é‡å¤å†å²è®°å½•**ï¼š
   - åŒä¸€æ¥å£å·å‡ºç°2æ¡å†å²è®°å½•
   - ä¸€æ¡æœ‰å®Œæˆæ—¥æœŸå’Œå›æ–‡å•å·
   - å¦ä¸€æ¡å§‹ç»ˆå¾…å®Œæˆä¸”æ— è®°å½•

### ç”¨æˆ·çš„åˆ†æ

> "æˆ‘ä¼¼ä¹å‘ç°äº†é—®é¢˜ï¼šç‚¹å‡»æ’åºåå¹¶æ²¡æœ‰çœŸçš„é‡æ–°æ’åºï¼æ˜¾ç¤ºçš„æ¥å£å·æ˜¯ä¸»æ˜¾ç¤ºçª—çš„æ˜¾ç¤ºæ¥å£å·ï¼Œè€Œä¸æ˜¯çœŸæ­£è¢«å†™å…¥æ•°æ®çš„æ¥å£å·ã€‚"

**ç”¨æˆ·åˆ†æå®Œå…¨æ­£ç¡®ï¼**

---

## ğŸ” æ ¹æœ¬åŸå› åˆ†æ

### é—®é¢˜é“¾è·¯

#### 1. Treeviewæ’åºåªæ”¹å˜æ˜¾ç¤ºé¡ºåº

```python
# window.py ç¬¬1610-1653è¡Œï¼š_sort_by_columnå‡½æ•°
def _sort_by_column(self, viewer, column_name, tab_name):
    # è·å–æ‰€æœ‰æ•°æ®
    data = []
    for item_id in viewer.get_children():
        values = viewer.item(item_id)['values']
        # ...
        data.append((sort_key, text, values, item_id))
    
    # æŒ‰æŒ‡å®šåˆ—æ’åº
    data.sort(reverse=reverse, key=lambda x: x[0])
    
    # é‡æ–°æ’åˆ—Treeviewä¸­çš„é¡¹
    for index, (_, text, values, item_id) in enumerate(data):
        viewer.move(item_id, '', index)  # â† åªæ”¹å˜æ˜¾ç¤ºé¡ºåºï¼
```

**å…³é”®**ï¼š
- `viewer.move()`åªæ”¹å˜Treeviewçš„**æ˜¾ç¤ºé¡ºåº**
- **æ²¡æœ‰é‡æ–°æ’åºåº•å±‚æ•°æ®**ï¼š`original_df`, `original_row_numbers`
- è¿™äº›åº•å±‚æ•°æ®ä»ç„¶æ˜¯åŸå§‹é¡ºåº

#### 2. ç‚¹å‡»äº‹ä»¶ä½¿ç”¨ä½ç½®ç´¢å¼•

```python
# window.py ç¬¬1014è¡Œï¼ˆä¿®æ”¹å‰ï¼‰
item_index = viewer.index(item_id)  # è¿”å›æ’åºåçš„æ˜¾ç¤ºä½ç½®
```

**é—®é¢˜**ï¼š
- `viewer.index(item_id)`è¿”å›çš„æ˜¯æ’åºåçš„ä½ç½®ï¼ˆ0, 1, 2...ï¼‰
- ä¾‹å¦‚ï¼šæ’åºåç¬¬1è¡Œï¼Œ`item_index = 0`

#### 3. ilocè®¿é—®åŸå§‹æœªæ’åºçš„æ•°æ®

```python
# window.py ç¬¬1041è¡Œï¼ˆä¿®æ”¹å‰ï¼‰
source_file = original_df.iloc[item_index]['source_file']
```

**é—®é¢˜**ï¼š
- `original_df`æ²¡æœ‰æ’åºï¼Œä»æ˜¯åŸå§‹é¡ºåº
- `iloc[0]`è®¿é—®çš„æ˜¯åŸå§‹ç¬¬1è¡Œï¼Œä¸æ˜¯æ’åºåçš„ç¬¬1è¡Œ

### ğŸ¯ å…·ä½“æ¡ˆä¾‹

**åŸå§‹æ•°æ®**ï¼ˆæœªæ’åºï¼‰ï¼š

| DataFrameç´¢å¼• | é¡¹ç›®å· | æ¥å£å· | æ¥å£æ—¶é—´ |
|--------------|--------|--------|----------|
| 0 | 1818 | AAA | 06.30 |
| 1 | 2016 | BBB | 05.15 |
| 2 | 2016 | CCC | 04.10 |

**ç”¨æˆ·ç‚¹å‡»"æ¥å£æ—¶é—´"åˆ—æ’åºï¼ˆå‡åºï¼‰**ï¼š

**Treeviewæ˜¾ç¤º**ï¼ˆæ’åºåï¼‰ï¼š

| æ˜¾ç¤ºä½ç½® | é¡¹ç›®å· | æ¥å£å· | æ¥å£æ—¶é—´ |
|---------|--------|--------|----------|
| 0 | 2016 | CCC | 04.10 |
| 1 | 2016 | BBB | 05.15 |
| 2 | 1818 | AAA | 06.30 |

**ç”¨æˆ·ç‚¹å‡»ä½ç½®0ï¼ˆCCCæ¥å£ï¼Œ2016é¡¹ç›®ï¼‰**ï¼š

```
1. viewer.index(item_id) â†’ è¿”å› 0ï¼ˆæ’åºåä½ç½®ï¼‰
2. original_df.iloc[0] â†’ è®¿é—®DataFrameç´¢å¼•0
3. ç´¢å¼•0 = 1818é¡¹ç›® - AAAæ¥å£ âŒ
4. æ•°æ®è¢«é”™è¯¯å†™å…¥åˆ°1818é¡¹ç›®ï¼
```

---

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### æ ¸å¿ƒæ€è·¯

**ä¸å†ä¾èµ–ä½ç½®ç´¢å¼•ï¼Œè€Œæ˜¯åœ¨æ’å…¥Treeviewæ—¶å­˜å‚¨å…ƒæ•°æ®ï¼Œç‚¹å‡»æ—¶ç›´æ¥è¯»å–ã€‚**

### ä¿®å¤1ï¼šæ’å…¥æ—¶å­˜å‚¨å…ƒæ•°æ®

**æ–‡ä»¶**: `window.py` ç¬¬730-785è¡Œ

```python
# ã€å…³é”®ã€‘åˆ›å»ºitemå…ƒæ•°æ®æ˜ å°„å­—å…¸ï¼Œå­˜å‚¨æ¯è¡Œçš„å…³é”®ä¿¡æ¯ï¼ˆä¸å—æ’åºå½±å“ï¼‰
if not hasattr(self, '_item_metadata'):
    self._item_metadata = {}

for index in range(max_rows):
    row = display_df.iloc[index]
    # ... æ„å»ºdisplay_values ...
    
    item_id = viewer.insert("", "end", text=display_text, values=display_values, tags=tags)
    
    # ã€å…³é”®ä¿®å¤ã€‘å­˜å‚¨å…ƒæ•°æ®åˆ°æ˜ å°„å­—å…¸
    metadata = {
        'original_index': index,  # åœ¨filtered_dfä¸­çš„ç´¢å¼•
        'original_row': original_row_numbers[index] if ... else index + 2,
        'source_file': row.get('source_file', '') if 'source_file' in row.index else '',
        'project_id': row.get('é¡¹ç›®å·', '') if 'é¡¹ç›®å·' in row.index else '',
        'interface_id': row.get('æ¥å£å·', '') if 'æ¥å£å·' in row.index else '',
        'source_column': row.get('_source_column', None) if '_source_column' in row.index else None,
    }
    self._item_metadata[(viewer, item_id)] = metadata
```

**ä¼˜ç‚¹**ï¼š
- æ¯ä¸ªitem_idéƒ½æœ‰è‡ªå·±çš„å…ƒæ•°æ®
- å…ƒæ•°æ®å­˜å‚¨åœ¨å­—å…¸ä¸­ï¼Œkeyæ˜¯`(viewer, item_id)`
- **æ’åºä¸å½±å“å…ƒæ•°æ®**ï¼Œå› ä¸º`item_id`ä¸å˜

### ä¿®å¤2ï¼šç‚¹å‡»æ—¶ä»å…ƒæ•°æ®è¯»å–

**æ–‡ä»¶**: `window.py` ç¬¬1029-1080è¡Œ

```python
# ã€å…³é”®ä¿®å¤ã€‘ä»å…ƒæ•°æ®æ˜ å°„å­—å…¸è·å–æ•°æ®ï¼Œä¸å—æ’åºå½±å“
metadata = self._item_metadata.get((viewer, item_id))
if not metadata:
    # å…œåº•ï¼šä½¿ç”¨æ—§é€»è¾‘ï¼ˆä½ç½®ç´¢å¼•ï¼‰
    print(f"[è­¦å‘Š] æœªæ‰¾åˆ°itemå…ƒæ•°æ®ï¼Œä½¿ç”¨ä½ç½®ç´¢å¼•ï¼ˆå¯èƒ½ä¸å‡†ç¡®ï¼‰")
    # ...
else:
    # ä»å…ƒæ•°æ®æå–ä¿¡æ¯
    original_row = metadata['original_row']
    source_file = metadata['source_file']
    project_id = str(metadata['project_id'])
    source_column = metadata['source_column']

print(f"[å›æ–‡è¾“å…¥] item_id: {item_id}")
print(f"[å›æ–‡è¾“å…¥] æºæ–‡ä»¶: {os.path.basename(source_file)}")
print(f"[å›æ–‡è¾“å…¥] é¡¹ç›®å·: {project_id}")
print(f"[å›æ–‡è¾“å…¥] Excelè¡Œå·: {original_row}")
```

**ä¼˜ç‚¹**ï¼š
- ç›´æ¥ä»`item_id`è·å–å…ƒæ•°æ®ï¼Œä¸ä¾èµ–ä½ç½®
- å³ä½¿Treeviewæ’åºï¼Œ`item_id`ä¸å˜ï¼Œå…ƒæ•°æ®ä»ç„¶æ­£ç¡®
- æ·»åŠ è¯¦ç»†æ—¥å¿—ï¼Œä¾¿äºéªŒè¯

### ä¿®å¤3ï¼šå‹¾é€‰æ¡†ä¹Ÿä½¿ç”¨å…ƒæ•°æ®

**æ–‡ä»¶**: `window.py` ç¬¬850-869è¡Œ

```python
# ã€å…³é”®ä¿®å¤ã€‘ä»å…ƒæ•°æ®æ˜ å°„å­—å…¸è·å–æ•°æ®ï¼Œä¸å—æ’åºå½±å“
metadata = self._item_metadata.get((viewer, item_id))
if not metadata:
    # å…œåº•ï¼šä½¿ç”¨æ—§é€»è¾‘
    print(f"[è­¦å‘Š] æœªæ‰¾åˆ°itemå…ƒæ•°æ®ï¼ˆå‹¾é€‰æ¡†ï¼‰")
    item_index = viewer.index(item_id)
    original_row = original_row_numbers[item_index] if ... else item_index + 2
    source_file = source_files[0] if len(source_files) == 1 else ...
else:
    # ä»å…ƒæ•°æ®æå–
    original_row = metadata['original_row']
    source_file = metadata['source_file']
```

### ä¿®å¤4ï¼šä¸Šçº§ç¡®è®¤ä¹Ÿä½¿ç”¨å…ƒæ•°æ®

**æ–‡ä»¶**: `window.py` ç¬¬895-907è¡Œ

```python
# ã€ä¿®å¤ã€‘ä»å…ƒæ•°æ®è·å–æ•°æ®
if metadata and metadata.get('original_index') is not None:
    original_index = metadata['original_index']
    if original_index < len(original_df):
        row_data = original_df.iloc[original_index]
    else:
        row_data = None
else:
    # å…œåº•ï¼šä½¿ç”¨ä½ç½®ç´¢å¼•
    item_index = viewer.index(item_id)
    row_data = original_df.iloc[item_index] if item_index < len(original_df) else None
```

---

## ğŸ“Š ä¿®å¤æ•ˆæœå¯¹æ¯”

### ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰

```
ç”¨æˆ·ç‚¹å‡»æ’åºï¼ˆå‡åºï¼‰
    â†“
Treeviewæ˜¾ç¤ºï¼šä½ç½®0=CCC(2016), ä½ç½®1=BBB(2016), ä½ç½®2=AAA(1818)
    â†“
ç”¨æˆ·ç‚¹å‡»ä½ç½®0ï¼ˆCCCï¼Œ2016é¡¹ç›®ï¼‰
    â†“
item_index = viewer.index(item_id) â†’ 0
    â†“
original_df.iloc[0] â†’ DataFrameç´¢å¼•0 â†’ AAAæ¥å£ï¼ˆ1818é¡¹ç›®ï¼‰âŒ
    â†“
æ•°æ®è¢«é”™è¯¯å†™å…¥åˆ°1818é¡¹ç›®ï¼
```

### ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰

```
ç”¨æˆ·ç‚¹å‡»æ’åºï¼ˆå‡åºï¼‰
    â†“
Treeviewæ˜¾ç¤ºï¼šä½ç½®0=CCC(2016), ä½ç½®1=BBB(2016), ä½ç½®2=AAA(1818)
    â†“
ç”¨æˆ·ç‚¹å‡»ä½ç½®0ï¼ˆCCCï¼Œ2016é¡¹ç›®ï¼‰
    â†“
metadata = self._item_metadata.get((viewer, item_id))
    â†“
metadata = {
    'source_file': 'æ”¶å‘æ–‡æ¸…å•2016.xlsx',
    'project_id': '2016',
    'interface_id': 'CCC',
    'original_row': 27450
}
    â†“
âœ… æ•°æ®æ­£ç¡®å†™å…¥åˆ°2016é¡¹ç›®ï¼
```

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯1ï¼šæŒ‰æ—¶é—´æ’åº

1. **å‡†å¤‡æ•°æ®**ï¼š
   - ç¡®ä¿æœ‰2016å’Œ1818ä¸¤ä¸ªé¡¹ç›®çš„æ··åˆæ•°æ®
   - æ¥å£æ—¶é—´ä¸åŒï¼ˆä¾‹å¦‚ï¼š1818æ˜¯06.30ï¼Œ2016æ˜¯04.10ï¼‰

2. **æµ‹è¯•æ­¥éª¤**ï¼š
   - ç‚¹å‡»"æ¥å£æ—¶é—´"è¡¨å¤´ï¼ŒæŒ‰å‡åºæ’åº
   - è§‚å¯ŸTreeviewæ˜¾ç¤ºé¡ºåºå˜åŒ–
   - ç‚¹å‡»æ’åºåçš„ç¬¬ä¸€è¡Œï¼ˆåº”è¯¥æ˜¯æ—¶é—´æœ€æ—©çš„æ¥å£ï¼‰
   - å¡«å†™å›æ–‡å•å·
   - **æ£€æŸ¥æ§åˆ¶å°è¾“å‡º**ï¼š
     ```
     [å›æ–‡è¾“å…¥] item_id: IXXXXX
     [å›æ–‡è¾“å…¥] æºæ–‡ä»¶: æ”¶å‘æ–‡æ¸…å•2016.xlsx
     [å›æ–‡è¾“å…¥] é¡¹ç›®å·: 2016
     [å›æ–‡è¾“å…¥] Excelè¡Œå·: 27450
     æˆåŠŸå†™å…¥: D:\Programs\æ¥å£ç­›é€‰\æµ‹è¯•æ–‡ä»¶\æ”¶å‘æ–‡æ¸…å•2016.xlsx, ...
     ```
   - **æ£€æŸ¥Excelæ–‡ä»¶**ï¼šåªæœ‰2016é¡¹ç›®çš„æ–‡ä»¶è¢«ä¿®æ”¹

3. **éªŒè¯**ï¼š
   - å†æ¬¡ç‚¹å‡»"æ¥å£æ—¶é—´"è¡¨å¤´ï¼ŒæŒ‰é™åºæ’åº
   - é‡å¤ä¸Šè¿°æµ‹è¯•ï¼ŒéªŒè¯é™åºæ’åºä¹Ÿæ­£å¸¸

### æµ‹è¯•åœºæ™¯2ï¼šæŒ‰é¡¹ç›®å·æ’åº

1. ç‚¹å‡»"é¡¹ç›®å·"è¡¨å¤´æ’åº
2. ç‚¹å‡»æ’åºåçš„ç¬¬ä¸€è¡Œ
3. éªŒè¯æ•°æ®å†™å…¥åˆ°æ­£ç¡®çš„é¡¹ç›®

### æµ‹è¯•åœºæ™¯3ï¼šå¤šæ¬¡æ’åº

1. å…ˆæŒ‰æ—¶é—´æ’åº
2. å†æŒ‰é¡¹ç›®å·æ’åº
3. å†æŒ‰æ¥å£å·æ’åº
4. ç‚¹å‡»ä»»æ„è¡Œ
5. éªŒè¯æ•°æ®å†™å…¥æ­£ç¡®

### æµ‹è¯•åœºæ™¯4ï¼šå‹¾é€‰æ¡†

1. æ’åºåï¼Œç‚¹å‡»"æ˜¯å¦å·²å®Œæˆ"å‹¾é€‰æ¡†
2. éªŒè¯å‹¾é€‰çŠ¶æ€æ­£ç¡®ä¿å­˜
3. å¦‚æœæ˜¯ä¸Šçº§è§’è‰²ï¼ŒéªŒè¯Registryç¡®è®¤é€»è¾‘æ­£ç¡®

---

## ğŸ”— ä¸å…¶ä»–ä¿®å¤çš„å…³è”

### ä¿®å¤1ï¼šDataFrameç´¢å¼•é‡ç½®ï¼ˆä¹‹å‰ï¼‰
- **é—®é¢˜**ï¼šç­›é€‰åç´¢å¼•ä¸è¿ç»­
- **ä¿®å¤**ï¼š`filtered_df.reset_index(drop=True)`
- **å±€é™**ï¼šåªè§£å†³ç­›é€‰é—®é¢˜ï¼Œ**ä¸è§£å†³æ’åºé—®é¢˜**

### ä¿®å¤2ï¼šå…ƒæ•°æ®æ˜ å°„ï¼ˆæœ¬æ¬¡ï¼‰
- **é—®é¢˜**ï¼šæ’åºåä½ç½®ç´¢å¼•é”™ä¹±
- **ä¿®å¤**ï¼šå­˜å‚¨å…ƒæ•°æ®ï¼Œä¸ä¾èµ–ä½ç½®
- **ä¼˜åŠ¿**ï¼š**å½»åº•è§£å†³æ’åºå’Œç­›é€‰é—®é¢˜**

### ä¸¤è€…å…³ç³»

```
DataFrameç­›é€‰ â†’ reset_index() â†’ ä½ç½®ç´¢å¼•è¿ç»­
    â†“
Treeviewæ’åº â†’ viewer.move() â†’ æ˜¾ç¤ºé¡ºåºæ”¹å˜
    â†“
å…ƒæ•°æ®æ˜ å°„ â†’ ä¸ä¾èµ–ä½ç½® â†’ âœ… å§‹ç»ˆæ­£ç¡®
```

---

## â“ ä¸ºä»€ä¹ˆä¼šå‡ºç°é‡å¤å†å²è®°å½•ï¼Ÿ

### ç”¨æˆ·é—®é¢˜

> "ä¸ºä»€ä¹ˆåœ¨æ£€æŸ¥å†å²çš„æ—¶å€™ä¼šå‡ºç°2ä¸ªç›¸åŒæ¥å£å·çš„å†å²ä»»åŠ¡ï¼Œä¸€ä¸ªæ˜¾ç¤ºç€å®Œæˆæ—¥æœŸå’Œå›æ–‡å•å·ï¼Œå¦ä¸€ä¸ªå§‹ç»ˆæ˜¯å¾…å®ŒæˆçŠ¶æ€ä¸”æ— è¾“å…¥è®°å½•ï¼Ÿ"

### åŸå› åˆ†æ

1. **ç¬¬ä¸€æ¬¡å¡«å†™å›æ–‡å•å·**ï¼š
   - ç”¨æˆ·ç‚¹å‡»2016é¡¹ç›®çš„æ¥å£A
   - å› ä¸ºæ’åºé—®é¢˜ï¼Œå®é™…å†™å…¥1818é¡¹ç›®çš„æ¥å£B
   - Registryè®°å½•ï¼š1818é¡¹ç›® - æ¥å£B - æœ‰å®Œæˆæ—¶é—´å’Œå›æ–‡å•å·

2. **ç¬¬äºŒæ¬¡å¡«å†™å›æ–‡å•å·**ï¼ˆæˆ–å…¶ä»–æ“ä½œï¼‰ï¼š
   - ç”¨æˆ·å†æ¬¡ç‚¹å‡»åŒä¸€æ¥å£ï¼ˆ2016é¡¹ç›®çš„æ¥å£Aï¼‰
   - è¿™æ¬¡å¯èƒ½æ­£ç¡®ï¼ˆæˆ–æ’åºååˆé”™äº†ï¼‰
   - å†™å…¥2016é¡¹ç›®çš„æ¥å£A
   - Registryè®°å½•ï¼š2016é¡¹ç›® - æ¥å£A - æœ‰å®Œæˆæ—¶é—´å’Œå›æ–‡å•å·

3. **æŸ¥è¯¢å†å²**ï¼š
   - ç”¨æˆ·æŸ¥è¯¢"æ¥å£A"
   - Registryè¿”å›æ‰€æœ‰åŒ…å«"æ¥å£A"çš„è®°å½•
   - **ç»“æœ**ï¼š
     - 1818é¡¹ç›®-æ¥å£Aï¼ˆä¹‹å‰è¯¯å†™å…¥ï¼Œæœ‰æ•°æ®ï¼‰
     - 2016é¡¹ç›®-æ¥å£Aï¼ˆæ­£ç¡®çš„ï¼Œå¯èƒ½æœ‰æ•°æ®æˆ–æ²¡æ•°æ®ï¼‰

### ä¸ºä»€ä¹ˆæœ‰çš„è®°å½•æ²¡æœ‰æ•°æ®ï¼Ÿ

å¯èƒ½åŸå› ï¼š
1. **Excelå†™å…¥éªŒè¯å¤±è´¥**ï¼ˆä¹‹å‰çš„bugï¼‰ï¼š
   - å†™å…¥å¤±è´¥ä½†Registryå·²æ›´æ–°
   - åæ¥é‡æ–°æ‰«æExcelå‘ç°æ²¡æ•°æ®
   - çŠ¶æ€è¢«é‡ç½®ä¸º"å¾…å®Œæˆ"

2. **è·¨é¡¹ç›®å†™å…¥åé‡ç½®**ï¼š
   - è¯¯å†™å…¥1818é¡¹ç›®å
   - ç”¨æˆ·ç»§ç»­å¤„ç†ï¼Œ2016é¡¹ç›®çš„æ¥å£è¢«æ‰«æ
   - Registryåˆ›å»ºæ–°è®°å½•ï¼ˆå¾…å®ŒæˆçŠ¶æ€ï¼‰

---

## âœ… å®ŒæˆçŠ¶æ€

**ä¿®å¤æ—¶é—´**ï¼š2025-11-10  
**æµ‹è¯•çŠ¶æ€**ï¼šâ³ å¾…ç”¨æˆ·éªŒè¯  
**æ¶‰åŠæ–‡ä»¶**ï¼š
- `window.py` (4å¤„ä¿®å¤)
- `document/2025-11-10_æ’åºå¯¼è‡´è·¨é¡¹ç›®é”™è¯¯çš„æ ¹æœ¬ä¿®å¤.md` (æ–°å»º)

**é¢„æœŸæ•ˆæœ**ï¼š
- âœ… æ’åºåç‚¹å‡»æ•°æ®ï¼Œå†™å…¥æ­£ç¡®çš„é¡¹ç›®æ–‡ä»¶
- âœ… æ§åˆ¶å°æ˜¾ç¤ºæ­£ç¡®çš„é¡¹ç›®å·å’Œæºæ–‡ä»¶
- âœ… å‹¾é€‰æ¡†çŠ¶æ€æ­£ç¡®ä¿å­˜
- âœ… ä¸Šçº§ç¡®è®¤é€»è¾‘æ­£ç¡®è§¦å‘
- âœ… ä¸å†å‡ºç°è·¨é¡¹ç›®é”™è¯¯å†™å…¥
- âœ… ä¸å†å‡ºç°é‡å¤çš„é”™è¯¯å†å²è®°å½•

---

## ğŸ“ å…³é”®æ•™è®­

### 1. Treeviewæ’åºçš„æœ¬è´¨

**æ•™è®­**ï¼š
- `viewer.move()`åªæ”¹å˜æ˜¾ç¤ºé¡ºåºï¼Œä¸æ”¹å˜æ•°æ®
- ä»»ä½•ä¾èµ–ä½ç½®ç´¢å¼•çš„æ“ä½œéƒ½ä¼šå‡ºé”™
- **å¿…é¡»ä½¿ç”¨ç‹¬ç«‹çš„æ ‡è¯†ç¬¦ï¼ˆå¦‚item_idï¼‰å­˜å‚¨å…ƒæ•°æ®**

### 2. ä½ç½®ç´¢å¼•çš„å±é™©æ€§

**æ•™è®­**ï¼š
- ä½ç½®ç´¢å¼•ï¼ˆ0, 1, 2...ï¼‰æå…¶è„†å¼±
- ä»»ä½•æ’åºã€ç­›é€‰ã€æ’å…¥ã€åˆ é™¤éƒ½ä¼šæ”¹å˜ä½ç½®
- **æ°¸è¿œä¸è¦ä¾èµ–ä½ç½®ç´¢å¼•æ¥å…³è”æ•°æ®**

### 3. å…ƒæ•°æ®å­˜å‚¨çš„æœ€ä½³å®è·µ

**æ­£ç¡®æ–¹å¼**ï¼š
```python
# æ’å…¥æ—¶å­˜å‚¨
item_id = viewer.insert(...)
metadata = {'source_file': ..., 'project_id': ...}
self._item_metadata[(viewer, item_id)] = metadata

# ä½¿ç”¨æ—¶è¯»å–
metadata = self._item_metadata.get((viewer, item_id))
```

**é”™è¯¯æ–¹å¼**ï¼š
```python
# ä¾èµ–ä½ç½®
item_index = viewer.index(item_id)
data = original_df.iloc[item_index]  # âŒ å±é™©ï¼
```

### 4. è°ƒè¯•æ—¥å¿—çš„ä»·å€¼

**æ•™è®­**ï¼š
- è¯¦ç»†çš„æ—¥å¿—å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå‘ç°é—®é¢˜
- æ—¥å¿—åº”åŒ…æ‹¬ï¼šitem_id, é¡¹ç›®å·, æºæ–‡ä»¶, è¡Œå·
- ä¾¿äºéªŒè¯ä¿®å¤æ˜¯å¦ç”Ÿæ•ˆ

---

**æŠ¥å‘Šå®Œæˆæ—¶é—´**ï¼š2025-11-10

**å…³é”®ä¿®å¤ç‚¹**ï¼š
1. æ’å…¥æ—¶å­˜å‚¨å…ƒæ•°æ®ï¼ˆç¬¬775-785è¡Œï¼‰
2. å›æ–‡è¾“å…¥ä½¿ç”¨å…ƒæ•°æ®ï¼ˆç¬¬1029-1080è¡Œï¼‰
3. å‹¾é€‰æ¡†ä½¿ç”¨å…ƒæ•°æ®ï¼ˆç¬¬850-869è¡Œï¼‰
4. ä¸Šçº§ç¡®è®¤ä½¿ç”¨å…ƒæ•°æ®ï¼ˆç¬¬895-907è¡Œï¼‰

**å½±å“èŒƒå›´**ï¼š
- âœ… æ‰€æœ‰æ–‡ä»¶ç±»å‹ï¼ˆ1-6ï¼‰
- âœ… æ‰€æœ‰æ’åºæ“ä½œ
- âœ… æ‰€æœ‰ç‚¹å‡»äº‹ä»¶ï¼ˆå›æ–‡è¾“å…¥ã€å‹¾é€‰æ¡†ï¼‰
- âœ… æ‰€æœ‰è§’è‰²ï¼ˆè®¾è®¡äººå‘˜ã€å®¤ä¸»ä»»ã€æ‰€é¢†å¯¼ç­‰ï¼‰

**é£é™©ç­‰çº§**ï¼šğŸ”´ğŸ”´ğŸ”´ æé«˜ï¼ˆå·²ä¿®å¤ï¼‰
**ä¿®å¤ä¼˜å…ˆçº§**ï¼šP0ï¼ˆç«‹å³æµ‹è¯•ï¼‰

