# 接口管理工具 - 使用说明

> **版本**: 2025.11.25.14  
> **适用对象**: 设计人员、室主任、所领导、管理员

---

## 1. 通用功能

### 1.1 程序启动

双击"接口筛选.exe"启动程序。首次启动时，程序会自动检查更新，若有新版本会提示您更新。

### 1.2 设置姓名

点击右上角的 **⚙ 设置** 按钮，在弹出的设置窗口中：
- 填写您的 **姓名**（必须与姓名角色表中一致）
- 姓名将用于识别您的角色和筛选您负责的任务

### 1.3 界面布局

程序主界面分为以下区域：
- **顶部**：文件夹路径设置、导出位置设置、设置按钮、帮助按钮
- **中部**：Excel文件信息显示区、项目号筛选复选框
- **主体**：6个选项卡，分别对应6种接口类型
- **底部**：功能按钮区、数据库状态显示、版本信息

### 1.4 设置文件夹路径

1. 点击 **浏览** 按钮选择包含接口Excel文件的文件夹
2. 默认路径为服务器共享文件夹
3. 点击 **刷新文件列表** 加载文件信息

### 1.5 6种接口类型

| 选项卡 | 接口类型 | 说明 |
|--------|----------|------|
| Tab 1 | 内部需打开接口 | 需要打开的内部接口任务 |
| Tab 2 | 内部需回复接口 | 需要回复的内部接口任务 |
| Tab 3 | 外部需打开接口 | 需要打开的外部接口任务 |
| Tab 4 | 外部需回复接口 | 需要回复的外部接口任务 |
| Tab 5 | 三维提资接口 | 三维模型相关的接口任务 |
| Tab 6 | 收发文函 | 收发文函记录 |

### 1.6 数据库状态

左下角显示数据库连接状态：
- ✅ **已连接**：数据库正常工作
- 🔄 **同步中**：正在上传/下载数据
- ⏳ **等待锁定**：等待其他用户释放数据库
- ⚠️ **未配置**：尚未设置数据文件夹
- ❌ **连接失败**：请检查网络或联系管理员

### 1.7 自动刷新

在设置中可以启用 **自动启动定时器**，程序将按设定间隔自动刷新数据。

---

## 2. 设计人员使用指南

设计人员是程序的主要使用者，负责查看和处理分配给自己的接口任务。

### 2.1 查看我的待办任务

1. 确保已在设置中填写正确的姓名
2. 点击 **刷新文件列表** 或 **开始处理**
3. 程序会自动筛选出"责任人"为您姓名的任务
4. 在各选项卡中查看分配给您的任务

### 2.2 任务列表说明

任务列表显示以下关键信息：
- **接口编号**：任务的唯一标识
- **接口描述**：任务的具体内容
- **接口时间**：任务截止日期
- **责任人**：任务负责人（即您的姓名）
- **科室**：所属科室
- **状态**：任务当前状态

**颜色标识**：
- 🔴 红色行：已延期任务（需优先处理）
- 普通行：正常进行中的任务

### 2.3 填写回复编号

当您完成某个接口任务后，需要填写回复编号：

1. 在任务列表中找到已完成的任务
2. **双击** 该行任务
3. 在弹出的对话框中输入 **回复编号**
4. 点击确认保存

**回复编号格式说明**：
- 格式通常为：日期-序号（如 1125-001）
- 请按照项目规定的格式填写

### 2.4 导出我的任务

1. 设置好 **导出结果位置**
2. 勾选需要导出的选项卡
3. 点击 **导出结果** 按钮
4. 导出的Excel文件将保存到指定位置

### 2.5 注意事项

- 请定期刷新任务列表，确保查看最新分配
- 延期任务会始终显示，请优先处理
- 如发现任务分配有误，请联系室主任

---

## 3. 室主任使用指南

室主任负责管理本室的任务分配和进度监控。

### 3.1 任务分配功能

室主任可以将未分配的任务指派给设计人员：

1. 在任务列表中找到"责任人"为空的任务
2. **右键点击** 该行任务
3. 选择 **指派责任人**
4. 从下拉列表中选择设计人员姓名
5. 点击确认保存

**批量分配**：
- 可以选择多行任务后一次性分配
- 使用 Ctrl+点击 选择多个任务

### 3.2 任务监控

室主任可以查看本室所有任务的进度：
- 任务列表自动按科室筛选（如一室主任只看结构一室的任务）
- 可以查看每个设计人员的任务完成情况

### 3.3 显示时间范围

室主任角色默认显示：
- **所有已延期任务**（无时间限制）
- **未来7个工作日内到期的任务**

此时间范围可在配置文件中调整。

### 3.4 确认回复

当设计人员填写回复编号后，室主任可以进行确认：

1. 查看已填写回复编号的任务
2. 核实回复内容正确
3. 确认任务完成状态

### 3.5 导出本室报表

1. 设置导出位置
2. 勾选需要导出的接口类型
3. 点击导出，生成本室的任务汇总表

---

## 4. 所领导使用指南

所领导可以查看全所的任务概况和紧急事项。

### 4.1 全局概览

所领导角色不按科室筛选，可以查看所有科室的任务。

### 4.2 显示时间范围

所领导角色默认显示：
- **所有已延期任务**（需要紧急关注）
- **未来2个工作日内到期的任务**

这意味着所领导看到的都是最紧急的事项。

### 4.3 报表导出

所领导可以导出全所的任务汇总报表：
- 包含所有科室的任务
- 按时间范围筛选后的数据

### 4.4 注意事项

- 所领导显示的是最紧急的任务，便于快速决策
- 如需查看更多历史任务，请联系管理员调整配置

---

## 5. 管理员使用指南

管理员负责系统配置和维护工作。

### 5.1 角色管理

角色信息存储在 `excel_bin/姓名角色表.xlsx` 中：

| 列 | 说明 |
|----|------|
| 姓名 | 用户的真实姓名 |
| 角色 | 用户角色（可多角色，用逗号分隔） |

**可用角色**：
- `设计人员`：普通设计人员
- `一室主任`、`二室主任`、`建筑总图室主任`：各室主任
- `所领导`：所级领导
- `管理员`：系统管理员
- `XXXX接口工程师`：项目接口工程师（如2016接口工程师）

### 5.2 配置文件说明

**config.json** - 主配置文件：

```json
{
  "folder_path": "数据文件夹路径",
  "export_folder_path": "导出位置",
  "user_name": "当前用户姓名",
  "auto_startup": false,
  "minimize_to_tray": true,
  "defaults": {
    "folder_path": "默认服务器路径",
    "export_path": "默认导出路径"
  },
  "role_export_days": {
    "一室主任": 7,
    "二室主任": 7,
    "建筑总图室主任": 7,
    "所领导": 2,
    "管理员": null,
    "设计人员": null
  }
}
```

**参数说明**：
- `role_export_days`：各角色的显示/导出时间范围（工作日）
  - `null` 表示无时间限制
  - 数字表示显示未来N个工作日内的任务

### 5.3 数据库维护

Registry数据库位于数据文件夹下的 `registry_data/registry.db`：
- 使用SQLite格式，支持多用户并发访问
- 采用WAL模式提高并发性能
- 数据库会自动迁移更新

**备份建议**：
- 定期备份 `registry_data` 文件夹
- 备份前确保没有用户正在使用程序

### 5.4 日志查看

点击 **打开监控器** 按钮可以查看实时日志：
- 显示文件处理进度
- 显示错误和警告信息
- 便于问题排查

### 5.5 更新管理

程序支持自动更新：
- 启动时自动检查更新
- 在设置中可以手动检查更新
- 更新文件存放在服务器指定位置

---

## 6. 常见问题解答

### Q1: 文件被占用怎么办？

**问题描述**：保存时提示"文件被占用"

**解决方法**：
1. 弹窗会显示当前占用文件的用户名
2. 等待该用户关闭文件后重试
3. 如果是自己占用，请关闭已打开的Excel文件
4. 如果持续出现，请联系管理员

### Q2: 数据库连接失败怎么办？

**问题描述**：左下角显示"连接失败"

**解决方法**：
1. 检查网络连接是否正常
2. 确认服务器文件夹是否可访问
3. 尝试重新点击"刷新文件列表"
4. 如果问题持续，请联系管理员

### Q3: 看不到分配给我的任务？

**问题描述**：刷新后任务列表为空

**解决方法**：
1. 确认设置中的姓名与姓名角色表完全一致
2. 确认您的角色已正确配置
3. 检查是否有项目号筛选被禁用
4. 联系室主任确认是否已分配任务

### Q4: 如何更新程序？

**问题描述**：需要更新到最新版本

**解决方法**：
1. 点击设置按钮（⚙）
2. 点击"检查更新"按钮
3. 如果有新版本，按提示进行更新
4. 更新完成后重启程序

### Q5: 回复编号填错了怎么办？

**问题描述**：需要修改已填写的回复编号

**解决方法**：
1. 重新双击该任务行
2. 在弹出的对话框中修改回复编号
3. 点击确认保存

### Q6: 导出的Excel文件在哪里？

**问题描述**：找不到导出的文件

**解决方法**：
1. 检查"导出结果位置"设置
2. 点击"打开文件夹"按钮直接打开导出目录
3. 导出文件名包含日期和项目号

### Q7: 程序启动很慢？

**问题描述**：程序启动或刷新时响应慢

**解决方法**：
1. 首次启动可能较慢，请耐心等待
2. 检查网络连接速度
3. 如果服务器路径较远，可以考虑使用本地缓存
4. 联系管理员检查服务器状态

### Q8: 如何最小化到托盘？

**问题描述**：希望程序在后台运行

**解决方法**：
1. 在设置中勾选"最小化到系统托盘"
2. 点击关闭按钮时，程序会最小化到托盘
3. 双击托盘图标可以恢复窗口
4. 右键托盘图标可以完全退出程序

---

## 联系与支持

如有其他问题，请联系：
- **技术支持**：建筑结构所信息化管理员
- **程序作者**：王任超

---

*本说明文档随程序版本更新，如有变动请以最新版本为准。*

